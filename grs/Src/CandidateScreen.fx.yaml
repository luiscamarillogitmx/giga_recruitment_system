CandidateScreen As screen:
    ContentLanguage: ="en-US"
    Fill: =Style.Palette.Background
    Height: |-
        =Max(
            App.Height,
            App.MinScreenHeight
        )
    LoadingSpinnerColor: =Color.Transparent
    OnVisible: |-
        =Concurrent(
            versioningPanel_CandidateScreen.Init(),
            If(
                IsBlank(forms),
                UpdateContext(
                    {
                        forms: {
                            GeneralInfoForm: {
                                Name: "General information",
                                Code: 0,
                                AcceptText: "Save",
                                CancelText: "Cancel",
                                SheetWidth: 400
                            },
                            JobContractInfoForm: {
                                Name: "General information",
                                Code: 1,
                                AcceptText: "Save",
                                CancelText: "Cancel",
                                SheetWidth: 900
                            }
                        }
                    }
                )
            ),
            If(
                verifySignedOffer,
                IfError(
                    With(
                        AppFunctions.LoadSignedOffers(candidate.candidateState.id),
                        UpdateContext({hasSignedOffer: !IsBlank(SignedOffers) && !IsEmpty(SignedOffers)})
                    ),
                    AppFunctions.NotifyError(
                        "Error consulting signed offers!",
                        FirstError.Message
                    )
                );
                UpdateContext({verifySignedOffer: false})
            );
            If(
                selectStep,
                UpdateContext(
                    {
                        processStep: If(
                            hasSignedOffer,
                            DeepScreen.Candidate.JobContract,
                            DeepScreen.Candidate.JobOffer
                        ),
                        selectStep: false
                    }
                )
            );
            Reset(timeline_CandidateScreen);
            If(
                IsBlank(versions) || UpdateVersions,
                versioningPanel_CandidateScreen.Refresh();
                Select(icoReloadCandidateApplications_CandidateScreen);
                Set(
                    UpdateVersions,
                    false
                );
                Set(
                    UpdateVersion,
                    false
                )
            );
            If(
                UpdateVersion,
                versioningPanel_CandidateScreen.Select();
                Set(
                    UpdateVersion,
                    false
                )
            )
        )
    Width: |-
        =Max(
            App.Width,
            App.MinScreenWidth
        )

    actLoadMetadata_CandidateScreen As Action:
        Action: =Self.OnAction()
        OnAction: |-
            =IfError(
                With(
                    ISignatureAPI.GetTemplateMetadata(version.Source.template.id) As metadata,
                    UpdateContext(
                        {
                            jobContractData: Patch(
                                jobContractData,
                                {
                                    Metadata: {
                                        IsLoaded: true,
                                        Value: metadata
                                    }
                                }
                            )
                        }
                    )
                ),
                AppFunctions.NotifyError(
                    "Error loading template metadata!",
                    FirstError.Message
                )
            )
        Visible: =false

    ctnLayout_CandidateScreen As groupContainer.horizontalAutoLayoutContainer:
        BorderColor: =Color.Transparent
        BorderStyle: =BorderStyle.None
        Fill: =Color.Transparent
        Height: =Parent.Height
        LayoutAlignItems: =LayoutAlignItems.Stretch
        LayoutMode: =LayoutMode.Auto
        Width: =Parent.Width
        ZIndex: =2

        sidebar_CandidateScreen As Sidebar:
            LayoutMinHeight: =50
            LayoutMinWidth: =640
            OnSelect: |-
                =If(
                    Item.InMaintenance,
                    Navigate(
                        MaintenanceScreen,
                        ScreenTransition.None,
                        {topLevelScreen: Item}
                    ),
                    Navigate(Item.Screen)
                )
            Select: =Sidebar.OnSelect(Item)
            SelectedItem: =sidebarSelectedItem

        shpSidebarSeparator_CandidateScreen As rectangle:
            BorderColor: =RGBA(32, 54, 71, 1)
            Fill: =Style.Palette.Line
            LayoutMinHeight: =50
            Width: =1
            ZIndex: =2

        ctnContent_CandidateScreen As groupContainer.verticalAutoLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            BorderColor: =Color.Transparent
            BorderStyle: =BorderStyle.None
            DropShadow: |-
                =If(
                    NewLook,
                    DropShadow.Semibold,
                    DropShadow.None
                )
            Fill: =Color.Transparent
            LayoutAlignItems: =LayoutAlignItems.Stretch
            LayoutDirection: =LayoutDirection.Vertical
            LayoutGap: |-
                =If(
                    NewLook,
                    15,
                    0
                )
            LayoutMinHeight: =100
            LayoutMinWidth: =250
            LayoutMode: =LayoutMode.Auto
            PaddingBottom: =Self.PaddingLeft
            PaddingLeft: |-
                =If(
                    NewLook,
                    15,
                    0
                )
            PaddingRight: =Self.PaddingLeft
            PaddingTop: =Self.PaddingLeft
            ZIndex: =3

            ctnToolBar_CandidateScreen As groupContainer.horizontalAutoLayoutContainer:
                AlignInContainer: =AlignInContainer.SetByContainer
                BorderColor: =Style.Palette.Line
                BorderStyle: |-
                    =If(
                        NewLook,
                        BorderStyle.Solid,
                        BorderStyle.None
                    )
                BorderThickness: =1
                DropShadow: |-
                    =If(
                        NewLook,
                        DropShadow.Semilight,
                        DropShadow.None
                    )
                Fill: =Color.Transparent
                FillPortions: =0
                Height: =42
                LayoutAlignItems: =LayoutAlignItems.Stretch
                LayoutMinHeight: =100
                LayoutMinWidth: =50
                LayoutMode: =LayoutMode.Auto
                RadiusBottomLeft: =Self.RadiusTopLeft
                RadiusBottomRight: =Self.RadiusTopLeft
                RadiusTopLeft: |-
                    =If(
                        NewLook,
                        Style.RadiusFactor,
                        0
                    )
                RadiusTopRight: =Self.RadiusTopLeft
                ZIndex: =1

                icoBack_CandidateScreen As icon.Check:
                    BorderColor: =Color.Transparent
                    BorderStyle: =BorderStyle.None
                    Color: =Style.Palette.Icon
                    DisabledBorderColor: =Color.Transparent
                    DisabledColor: =Style.Palette.Disabled
                    DisplayMode: |-
                        =//If(
                        //    FirstScreen;
                            //DisplayMode.Disabled
                        DisplayMode.Edit
                        //)
                    Fill: =Style.Palette.Selectable.Fill
                    FocusedBorderColor: =Style.Palette.Border
                    FocusedBorderThickness: =0
                    Height: =Parent.Height
                    HoverBorderColor: =Self.BorderColor
                    HoverColor: =Self.Color
                    HoverFill: =Style.Palette.Selectable.HoverFill
                    Icon: =Icon.ArrowLeft
                    LayoutMinHeight: =17
                    OnSelect: |-
                        =If(
                            isFirstScreen,
                            Navigate(CandidatesScreen),
                            Back()
                        )
                    PaddingBottom: =12.5
                    PaddingLeft: =12.5
                    PaddingRight: =12.5
                    PaddingTop: =12.5
                    PressedBorderColor: =Self.Color
                    PressedColor: =Self.Color
                    PressedFill: =Style.Palette.Selectable.PressedFill
                    Tooltip: ="Back to previus screen"
                    Width: =Self.Height
                    ZIndex: =1

                shpBackSeparator_CandidateScreen As rectangle:
                    BorderColor: =Color.Transparent
                    BorderStyle: =BorderStyle.None
                    DisplayMode: =DisplayMode.View
                    Fill: =Style.Palette.Line
                    FocusedBorderThickness: =0
                    LayoutMinHeight: =20
                    Width: =1
                    ZIndex: =3

                ctnCommonActionsCandidateScreen As groupContainer.horizontalAutoLayoutContainer:
                    BorderColor: =Color.Transparent
                    BorderStyle: =BorderStyle.None
                    Fill: =Color.Transparent
                    LayoutAlignItems: =LayoutAlignItems.Stretch
                    LayoutJustifyContent: =LayoutJustifyContent.End
                    LayoutMinHeight: =17
                    LayoutMinWidth: =250
                    LayoutMode: =LayoutMode.Auto
                    ZIndex: =5

                    btnRecharge_candidateScreen As LabeledIconButton:
                        Icon: =Icon.Reload
                        LayoutMinHeight: =25
                        LayoutMinWidth: =640
                        OnSelect: =versioningPanel_CandidateScreen.Select()
                        Select: |-
                            =If(
                                Self.Enable,
                                Self.OnSelect()
                            )
                        Text: ="Recargar"
                        Visible: =false
                        Width: =95

                    commonTools_CandidateScreen As CommonTools:
                        LayoutMinHeight: =17
                        LayoutMinWidth: =50
                        OnChangeStyle: |-
                            =Concurrent(
                                Set(
                                    Style,
                                    Self.SelectedStyle
                                ),
                                Patch(
                                    Cache,
                                    LookUp(
                                        Cache,
                                        Key = "style"
                                    ),
                                    {Value: Self.SelectedStyle.Name}
                                );
                                IfError(
                                    SaveData(
                                        Cache,
                                        "GRS"
                                    ),
                                    Blank()
                                )
                            )
                        OnSelectBell: |-
                            =UpdateContext({notificationPanelVisible: true})
                        ZIndex: =2

            shpToolbarSeparator_CandidateScreen As rectangle:
                BorderColor: =Color.Transparent
                BorderStyle: =BorderStyle.None
                DisplayMode: =DisplayMode.View
                Fill: =Style.Palette.Line
                FocusedBorderThickness: =0
                Height: =1
                Visible: =!NewLook
                ZIndex: =2

            ctnBody_CandidateScreen As groupContainer.verticalAutoLayoutContainer:
                AlignInContainer: =AlignInContainer.SetByContainer
                BorderColor: =Style.Palette.Line
                BorderStyle: |-
                    =If(
                        NewLook,
                        BorderStyle.Solid,
                        BorderStyle.None
                    )
                BorderThickness: =1
                DropShadow: |-
                    =If(
                        NewLook,
                        DropShadow.Semilight,
                        DropShadow.None
                    )
                Fill: =Color.Transparent
                Height: =62
                LayoutAlignItems: =LayoutAlignItems.Stretch
                LayoutDirection: =LayoutDirection.Vertical
                LayoutMinHeight: =100
                LayoutMinWidth: =50
                LayoutMode: =LayoutMode.Auto
                PaddingLeft: |-
                    =If(
                        NewLook,
                        15,
                        20
                    )
                PaddingRight: =Self.PaddingLeft
                RadiusBottomLeft: =Self.RadiusTopLeft
                RadiusBottomRight: =Self.RadiusTopLeft
                RadiusTopLeft: |-
                    =If(
                        NewLook,
                        Style.RadiusFactor,
                        0
                    )
                RadiusTopRight: =Self.RadiusTopLeft
                ZIndex: =3

                ctnHead_CandidateScreen As groupContainer.horizontalAutoLayoutContainer:
                    BorderColor: =Color.Transparent
                    BorderStyle: =BorderStyle.None
                    Fill: =Color.Transparent
                    FillPortions: =0
                    Height: =60
                    LayoutAlignItems: =LayoutAlignItems.Center
                    LayoutMinHeight: =60
                    LayoutMinWidth: =250
                    LayoutMode: =LayoutMode.Auto
                    ZIndex: =1

                    lblScreenTitle_CandidateScreen As label:
                        BorderColor: =Color.Transparent
                        BorderStyle: =BorderStyle.None
                        Color: =Style.Text.Title.Color
                        DisabledBorderColor: =Color.Transparent
                        DisabledColor: =Style.Palette.Disabled
                        DisabledFill: =Color.Transparent
                        DisplayMode: =DisplayMode.View
                        Fill: =Color.Transparent
                        FillPortions: =1
                        Font: =Style.Text.Title.Font
                        FontWeight: =Style.Text.Title.Weight
                        PaddingLeft: =15
                        Size: =Style.Text.Title.Size
                        Text: =$"{candidate.candidateState.candidateInfo.fullName} ({candidate.candidateState.candidateInfo.idATS})"
                        Tooltip: =candidate.candidateState.candidateInfo.email
                        ZIndex: =3

                    btnShareCandidate_CandidateScreen As LabeledIconButton:
                        Enable: =GrantAccess.Candidate.Share
                        Icon: =Icon.Share
                        LayoutMinHeight: =25
                        LayoutMinWidth: =640
                        OnSelect: |-
                            =UpdateContext(
                                {
                                    shareDialogModel: {
                                        Title: $"Share: {candidate.candidateState.candidateInfo.fullName} ({candidate.candidateState.candidateInfo.idATS})",
                                        ResourceId: candidate.candidateState.id,
                                        Param: $"{DeepScreen.Candidate.EntityType}:{candidate.candidateState.id}"
                                    }
                                }
                            )
                        RadiusBottonLeft: =Style.RadiusFactor
                        RadiusBottonRigth: =Style.RadiusFactor
                        RadiusTopLeft: =Style.RadiusFactor
                        RadiusTopRigth: =Style.RadiusFactor
                        Select: |-
                            =If(
                                Self.Enable,
                                Self.OnSelect()
                            )
                        Text: ="Share"
                        Tooltip: ="Share the current candidate"
                        Visible: =GrantAccess.Candidate.Share
                        Width: =70
                        ZIndex: =4

                ctnDetails_Candidate As groupContainer.verticalAutoLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    BorderColor: =Color.Transparent
                    BorderStyle: =BorderStyle.None
                    Fill: =Color.Transparent
                    FillPortions: =0
                    Height: =42
                    LayoutAlignItems: =LayoutAlignItems.Stretch
                    LayoutMinHeight: =50
                    LayoutMinWidth: =50
                    LayoutMode: =LayoutMode.Auto
                    ZIndex: =2

                    fldCandidateEmail_CandidateScreen As ShowerField:
                        Icon: =Icon.Mail
                        Key: ="Personal email"
                        LayoutMinHeight: =17
                        LayoutMinWidth: =640
                        Value: =candidate.candidateState.candidateInfo.email

                    fldCandidateStatus_CandidateScreen As ShowerField:
                        Icon: =Icon.Flag
                        Key: ="ATS status"
                        LayoutMinHeight: =20
                        LayoutMinWidth: =640
                        Value: =candidate.candidateState.status
                        ZIndex: =2

                    fldApplicationDate_CandidateScreen As ShowerField:
                        Icon: =Icon.CalendarBlank
                        Key: ="Application date time"
                        LayoutMinHeight: =17
                        LayoutMinWidth: =640
                        Tooltip: =AppFunctions.FormatLongDateTimeValue(candidate.candidateState.applicationDate)
                        Value: =AppFunctions.FormatDateTimeValue(candidate.candidateState.applicationDate)
                        ZIndex: =3

                    fldDepartment_CandidateScreen As ShowerField:
                        EnableRightSeparator: =false
                        Icon: =Icon.OfficeBuilding
                        Key: ="Department"
                        LayoutMinHeight: =17
                        LayoutMinWidth: =640
                        Value: =candidate.jobPosition.department.name
                        ZIndex: =4

                    ctnActions_Candidate As groupContainer.verticalAutoLayoutContainer:
                        AlignInContainer: =AlignInContainer.SetByContainer
                        BorderColor: =Color.Transparent
                        BorderStyle: =BorderStyle.None
                        Fill: =Color.Transparent
                        LayoutAlignItems: =LayoutAlignItems.Stretch
                        LayoutJustifyContent: =LayoutJustifyContent.End
                        LayoutMinHeight: =17
                        LayoutMinWidth: =60
                        LayoutMode: =LayoutMode.Auto
                        PaddingRight: =1
                        Width: =450
                        ZIndex: =5

                        lblCurrentRequisition_CandidateScreen As label:
                            Align: =Align.Right
                            BorderColor: =Color.Transparent
                            BorderStyle: =BorderStyle.None
                            Color: =Style.Text.Normal.Color
                            DisabledBorderColor: =Color.Transparent
                            DisabledColor: =Style.Palette.Disabled
                            DisabledFill: =Color.Transparent
                            DisplayMode: =DisplayMode.View
                            Fill: =Color.Transparent
                            Font: =Style.Text.Normal.Font
                            FontWeight: =Style.Text.Normal.Weight
                            Size: =Style.Text.Normal.Size
                            Text: ="Job requisition"
                            ZIndex: =1

                        droJobRequisition_CandidateScreen As dropdown:
                            AlignInContainer: =AlignInContainer.Center
                            BorderColor: =Color.Transparent
                            BorderThickness: =1
                            ChevronBackground: =Self.Fill
                            ChevronDisabledBackground: =Color.Transparent
                            ChevronDisabledFill: =Color.Transparent
                            ChevronFill: =Style.Palette.Accent
                            ChevronHoverBackground: =Style.Palette.Selectable.HoverFill
                            Color: =Style.Palette.Accent         
                            Default: =$"{candidate.jobPosition.title} ({candidate.jobPosition.tag})"
                            DisabledBorderColor: =Color.Transparent
                            DisabledColor: =Style.Palette.Disabled
                            DisabledFill: =Style.Palette.Fillable
                            Fill: =Style.Palette.Background
                            FocusedBorderColor: =Style.Palette.Accent
                            FocusedBorderThickness: =2
                            Font: =Style.Text.Subtitle.Font
                            FontWeight: =Style.Text.Subtitle.Weight
                            Height: =32
                            HoverBorderColor: =Style.Palette.Border
                            HoverFill: =Style.Palette.Selectable.HoverFill
                            Items: |-
                                =ForAll(
                                    applications,
                                    {
                                        IdCandidate: candidateState.id,
                                        IdJobPosition: jobPosition.id,
                                        JobPositionTitle: $"{jobPosition.title} ({jobPosition.tag})"
                                    }
                                )
                            LayoutMinHeight: =15
                            LayoutMinWidth: =50
                            OnChange: |-
                                =UpdateContext({popLoadVisible: true});
                                IfError(
                                    With(
                                        ISignatureAPI.GetJobPosition(Self.Selected.IdJobPosition) As jobPosition,
                                        UpdateContext(
                                            {
                                                candidate: LookUp(
                                                    applications,
                                                    candidateState.id = Self.Selected.IdCandidate
                                                ),
                                                jobPosition: jobPosition,
                                                versions: Blank(),
                                                version: Blank(),
                                                jobOfferData: Blank()
                                            }
                                        );
                                        versioningPanel_CandidateScreen.Refresh()
                                    ),
                                    AppFunctions.NotifyError(
                                        "Error loading job requisition!",
                                        FirstError.Message,
                                        "An error occurred while loading the job requisition data."
                                    );
                                    Reset(Self)
                                );
                                UpdateContext({popLoadVisible: false})
                            PaddingLeft: =7
                            PressedFill: =Style.Palette.Selectable.PressedFill
                            SelectionColor: =Style.Palette.Accent
                            SelectionFill: |-
                                =ColorFade(
                                    Style.Palette.Fillable,
                                    -5%
                                )
                            Size: =Style.Text.Subtitle.Size
                            Width: =300
                            ZIndex: =2

                        icoReloadCandidateApplications_CandidateScreen As icon.ArrowRight:
                            AlignInContainer: =AlignInContainer.Center
                            BorderColor: =Color.Transparent
                            BorderStyle: =BorderStyle.None
                            Color: =Style.Palette.Accent
                            DisabledBorderColor: =Color.Transparent
                            DisabledColor: =Style.Palette.Disabled
                            Fill: =Color.Transparent
                            FocusedBorderThickness: =0
                            Height: =32
                            HoverBorderColor: =Self.BorderColor
                            HoverColor: =Self.Color
                            HoverFill: =Style.Palette.Selectable.HoverFill
                            Icon: =Icon.Reload
                            OnSelect: |-
                                =//UpdateContext({popLoadVisible: true});;
                                UpdateContext(
                                    {
                                        applications: IfError(
                                            ISignatureAPI.GetCandidateApplications(candidate.candidateState.candidateInfo.idATS),
                                            AppFunctions.NotifyError(
                                                "Error loading other candidate applications!",
                                                FirstError.Message
                                            );
                                            applications
                                        )
                                    }
                                );
                                //UpdateContext({popLoadVisible: false})
                            PaddingBottom: =7.5
                            PaddingLeft: =7.5
                            PaddingRight: =7.5
                            PaddingTop: =7.5
                            PressedBorderColor: =Self.BorderColor
                            PressedColor: =Self.Color
                            PressedFill: =Style.Palette.Selectable.PressedFill
                            Tooltip: ="Reload job requisition list"
                            Width: =32
                            ZIndex: =3

                ctnRecruimentProcess_CandidateScreen As groupContainer.verticalAutoLayoutContainer:
                    BorderColor: =Color.Transparent
                    BorderStyle: =BorderStyle.None
                    Fill: =Color.Transparent
                    LayoutAlignItems: =LayoutAlignItems.Stretch
                    LayoutDirection: =LayoutDirection.Vertical
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    LayoutMode: =LayoutMode.Auto
                    PaddingTop: =10
                    ZIndex: =3

                    timeline_CandidateScreen As Timeline:
                        Default: =processStep
                        InfoBlockWidth: =275
                        IsLoading: =isLoadingVersions || isLoadingVersion
                        Items: |-
                            =Table(
                                Patch(
                                    DeepScreen.Candidate.JobOffer,
                                    {
                                        Blocked: false,
                                        Mark: hasSignedOffer
                                    }
                                ),
                                Patch(
                                    DeepScreen.Candidate.JobContract,
                                    {
                                        Blocked: !hasSignedOffer,
                                        Mark: false
                                    }
                                )
                            )
                        LayoutMinHeight: =640
                        LayoutMinWidth: =640
                        OnSelect: |-
                            =If(
                                processStep.Index <> Self.Selected.Index,
                                UpdateContext(
                                    {
                                        processStep: Self.Selected,
                                        version: Blank(),
                                        versions: Blank(),
                                        jobOfferData: Blank(),
                                        jobContractData: Blank(),
                                        signedJobOffer: Blank()
                                    }
                                );
                                versioningPanel_CandidateScreen.Refresh()
                            )
                        Select: =Self.OnSelect()
                        Subtitle: |-
                            =If(
                                hasSignedOffer,
                                "Job offer signed",
                                "In progress"
                            )
                        Title: ="Recruitment process"

                    ctnStepContent_CandidateScreen As groupContainer.horizontalAutoLayoutContainer:
                        AlignInContainer: =AlignInContainer.SetByContainer
                        BorderColor: =Color.Transparent
                        BorderStyle: =BorderStyle.None
                        Fill: =Color.Transparent
                        LayoutAlignItems: =LayoutAlignItems.Stretch
                        LayoutGap: =15
                        LayoutMinHeight: =100
                        LayoutMinWidth: =250
                        LayoutMode: =LayoutMode.Auto
                        ZIndex: =3

                        ctnPinnedPanels_CandidateScreen As groupContainer.verticalAutoLayoutContainer:
                            BorderColor: =Color.Transparent
                            BorderStyle: =BorderStyle.None
                            Fill: =Color.Transparent
                            FillPortions: =0
                            LayoutDirection: =LayoutDirection.Vertical
                            LayoutGap: =15
                            LayoutMinHeight: =100
                            LayoutMinWidth: =250
                            LayoutMode: =LayoutMode.Auto
                            PaddingBottom: =15
                            PaddingTop: =15
                            Width: =versioningPanel_CandidateScreen.Width
                            ZIndex: =1

                            versioningPanel_CandidateScreen As VersioningPanel:
                                BuildSignableInfo: =AppFunctions.BuildSignableInfo(Signable)
                                Default: =version.Source
                                EnableAdd: |-
                                    =//!IsReadOnly
                                    /*&& With(
                                        First(versioningPanel_CandidateScreen.Items);
                                        IsBlank(ThisRecord) || status = VersionState.Canceled.Code
                                    )*/
                                    Switch(
                                        processStep.Code,
                                        DeepScreen.Candidate.JobOffer.Code,
                                        GrantAccess.Candidate.JobOffer.Create,
                                        DeepScreen.Candidate.JobContract.Code,
                                        GrantAccess.Candidate.JobContract.Create
                                    )
                                FillPortions: =1
                                Init: |-
                                    =If(
                                        !Initialized,
                                        Reset(Self);
                                        Set(
                                            Initialized,
                                            true
                                        )
                                    )
                                IsLoading: =isLoadingVersions
                                Items: =versions
                                LayoutMinHeight: =50
                                LayoutMinWidth: =640
                                OnAdd: |-
                                    =Concurrent(
                                        If(
                                            IsBlank(templates.Items) || processStep.Index <> templates.Type.Index,
                                            templateSelector_CandidateScreen.Refresh()
                                        ),
                                        UpdateContext({templateSelectorVisible: true})
                                    )
                                OnRefresh: |-
                                    =UpdateContext({isLoadingVersions: true});
                                    With(
                                        {
                                            loadedVersions: IfError(
                                                Switch(
                                                    processStep.Code,
                                                    DeepScreen.Candidate.JobOffer.Code,
                                                    ISignatureAPI.GetJobOfferVersions(candidate.candidateState.id),
                                                    DeepScreen.Candidate.JobContract.Code,
                                                    ISignatureAPI.GetJobContractVersions(candidate.candidateState.id)
                                                ),
                                                AppFunctions.NotifyError(
                                                    $"Error loading {processStep.LowerName} version list!",
                                                    FirstError.Message,
                                                    $"Unable to load {processStep.LowerName} versions associated with candidate <strong>{candidate.candidateState.candidateInfo.fullName} ({candidate.candidateState.candidateInfo.idATS})</strong>."
                                                );
                                                Blank()
                                            )
                                        },
                                        UpdateContext(
                                            {
                                                versions: Sort(
                                                    loadedVersions,
                                                    DateTimeValue(createdOn),
                                                    SortOrder.Descending
                                                )
                                            }
                                        )
                                    );
                                    If(
                                        processStep.Code = DeepScreen.Candidate.JobOffer.Code,
                                        UpdateContext(
                                            {
                                                hasSignedOffer: !IsBlank(
                                                    LookUp(
                                                        versions,
                                                        status = VersionState.Signed.Code
                                                    )
                                                )
                                            }
                                        )
                                    );
                                    If(
                                        !IsBlank(versions) && !IsEmpty(versions),
                                        Self.Select(),
                                        UpdateContext(
                                            {
                                                version: Blank(),
                                                jobOfferData: Blank(),
                                                jobContractData: Blank(),
                                                signedJobOffer: Blank()
                                            }
                                        )
                                    );
                                    UpdateContext({isLoadingVersions: false})
                                OnSelect: |-
                                    =With(
                                        Self.Selected As selected,
                                        UpdateContext(
                                            {
                                                version: AppFunctions.SelectVersion(
                                                    versions,
                                                    If(
                                                        !isCreatingVersion && !IsBlank(selected.id),
                                                        selected,
                                                        version.Source
                                                    ),
                                                    Switch(
                                                        processStep.Code,
                                                        DeepScreen.Candidate.JobOffer.Code,
                                                        !GrantAccess.Candidate.JobOffer.Edit,
                                                        DeepScreen.Candidate.JobContract.Code,
                                                        !GrantAccess.Candidate.JobContract.Edit
                                                    )
                                                ),
                                                isLoadingVersion: true,
                                                isCreatingVersion: false
                                            }
                                        )
                                    );
                                    Switch(
                                        processStep.Code,
                                        DeepScreen.Candidate.JobOffer.Code,
                                        UpdateContext(
                                            {
                                                jobOfferData: IfError(
                                                    With(
                                                        ISignatureAPI.GetJobOfferVersion(version.Source.id),
                                                        {
                                                            GeneralInfo: {
                                                                Exists: !IsBlank(generalInfo),
                                                                Source: generalInfo,
                                                                Status: AppFunctions.CodeToVersionSectionState(
                                                                    generalInfo.status,
                                                                    If(
                                                                        version.IsActive,
                                                                        VersionSectionState.Opened,
                                                                        VersionSectionState.Locked
                                                                    )
                                                                ),
                                                                IsCheck: generalInfo.status = VersionSectionState.Completed.Code,
                                                                IndicatorState: AppFunctions.SectionCodeToComparableValue(
                                                                    generalInfo.status,
                                                                    0
                                                                ),
                                                                DisplayMode: DisplayMode. View,
                                                                IsMark: !version.IsClosed,
                                                                EnableEditData: !version.IsReadOnly && version.IsActive
                                                            },
                                                            SalaryPackage: With(
                                                                {
                                                                    exists: !IsBlank(salaryPackage),
                                                                    prevIsCompleted: generalInfo.status = VersionSectionState.Completed.Code
                                                                },
                                                                {
                                                                    Exists: exists,
                                                                    Source: salaryPackage,
                                                                    Status: If(
                                                                        !exists && prevIsCompleted,
                                                                        VersionSectionState.Opened,
                                                                        AppFunctions.CodeToVersionSectionState(salaryPackage.status)
                                                                    ),
                                                                    IsCheck: salaryPackage.status = VersionSectionState.Completed.Code,
                                                                    IndicatorState: If(
                                                                        !exists && prevIsCompleted,
                                                                        0,
                                                                        AppFunctions.SectionCodeToComparableValue(salaryPackage.status)
                                                                    ),
                                                                    DisplayMode: AppFunctions.BooleanToViewDisplayMode(exists || prevIsCompleted),
                                                                    IsMark: !version.IsClosed && (exists || generalInfo.status = VersionSectionState.Completed.Code),
                                                                    IsEnableDetailAccess: GrantAccess.Candidate.JobOffer.SalaryPackage.ViewAccess && (prevIsCompleted || exists) && salaryPackage.status <> VersionSectionState.Waiting.Code,
                                                                    IsEnableRequestTo: !version.IsReadOnly && version.IsActive && !exists && prevIsCompleted,
                                                                    Currencies: {
                                                                        IsLoaded: false,
                                                                        Value: AppFunctions.CurrencySamples
                                                                    }
                                                                }
                                                            ),
                                                            FinancialBreakdown: With(
                                                                {
                                                                    exists: !IsBlank(financialBreakdown),
                                                                    prevIsCompleted: salaryPackage.status = VersionSectionState.Completed.Code
                                                                },
                                                                {
                                                                    Exists: exists,
                                                                    Source: financialBreakdown,
                                                                    Status: If(
                                                                        !exists && prevIsCompleted,
                                                                        VersionSectionState.Opened,
                                                                        AppFunctions.CodeToVersionSectionState(financialBreakdown.status)
                                                                    ),
                                                                    IsCheck: financialBreakdown.status = VersionSectionState.Completed.Code,
                                                                    IndicatorState: If(
                                                                        !exists && prevIsCompleted,
                                                                        0,
                                                                        AppFunctions.SectionCodeToComparableValue(financialBreakdown.status)
                                                                    ),
                                                                    DisplayMode: AppFunctions.BooleanToViewDisplayMode(exists || prevIsCompleted),
                                                                    IsMark: !version.IsClosed && (exists || prevIsCompleted),
                                                                    IsEnableDetailAccess: (prevIsCompleted || exists) && financialBreakdown.status <> VersionSectionState.Waiting.Code,
                                                                    IsEnableRequestTo: !version.IsReadOnly && version.IsActive && !exists && prevIsCompleted,
                                                                    Breakdown: {
                                                                        IsLoaded: false,
                                                                        Value: AppFunctions.DynamicFieldsStructure
                                                                    }
                                                                }
                                                            ),
                                                            OfferSignature: With(
                                                                {
                                                                    exists: !IsBlank(workflow),
                                                                    prevIsCompleted: financialBreakdown.status = VersionSectionState.Completed.Code
                                                                },
                                                                {
                                                                    Exists: exists,
                                                                    Source: workflow,
                                                                    Status: If(
                                                                        !exists && prevIsCompleted,
                                                                        WorkflowStatus.Ready,
                                                                        AppFunctions.CodeToWorkflowStatus(workflow.status)
                                                                    ),
                                                                    IsCheck: workflow.status = WorkflowStatus.Sent.Code,
                                                                    IndicatorState: If(
                                                                        !exists && prevIsCompleted,
                                                                        0,
                                                                        AppFunctions.WorkflowCodeToComparableValue(workflow.status)
                                                                    ),
                                                                    DisplayMode: AppFunctions.BooleanToViewDisplayMode(exists || prevIsCompleted),
                                                                    IsMark: !version.IsClosed && (exists || prevIsCompleted),
                                                                    IsEnableSend: GrantAccess.Candidate.JobOffer.Launch && version.IsActive && !exists && prevIsCompleted
                                                                }
                                                            )
                                                        }
                                                    ),
                                                    AppFunctions.NotifyError(
                                                        "Error loading job offer data!",
                                                        FirstError.Message
                                                    );
                                                    Blank()
                                                )
                                            }
                                        );
                                        UpdateContext({isLoadingVersion: false}),
                                        DeepScreen.Candidate.JobContract.Code,
                                        UpdateContext(
                                            {
                                                jobContractData: IfError(
                                                    With(
                                                        ISignatureAPI.GetJobContractVersion(version.Source.id),
                                                        {
                                                            GeneralInfo: {
                                                                Exists: !IsBlank(generalInfo),
                                                                Source: generalInfo,
                                                                Status: AppFunctions.CodeToVersionSectionState(
                                                                    generalInfo.status,
                                                                    If(
                                                                        version.IsActive,
                                                                        VersionSectionState.Opened,
                                                                        VersionSectionState.Locked
                                                                    )
                                                                ),
                                                                IsCheck: generalInfo.status = VersionSectionState.Completed.Code,
                                                                IndicatorState: AppFunctions.SectionCodeToComparableValue(
                                                                    generalInfo.status,
                                                                    0
                                                                ),
                                                                DisplayMode: DisplayMode.View,
                                                                IsMark: !version.IsClosed,
                                                                IsEnableEdit: !version.IsReadOnly && version.IsActive
                                                            },
                                                            CandidatePersonalInfo: With(
                                                                {
                                                                    exists: !IsBlank(candidatePersonalInfo),
                                                                    prevIsCompleted: generalInfo.status = VersionSectionState.Completed.Code
                                                                },
                                                                {
                                                                    Exists: exists,
                                                                    Source: candidatePersonalInfo,
                                                                    Status: If(
                                                                        !exists && prevIsCompleted,
                                                                        VersionSectionState.Opened,
                                                                        AppFunctions.CodeToVersionSectionState(candidatePersonalInfo.status)
                                                                    ),
                                                                    IsCheck: candidatePersonalInfo.status = VersionSectionState.Completed.Code,
                                                                    IndicatorState: If(
                                                                        !exists && prevIsCompleted,
                                                                        0,
                                                                        AppFunctions.SectionCodeToComparableValue(candidatePersonalInfo.status)
                                                                    ),
                                                                    DisplayMode: AppFunctions.BooleanToViewDisplayMode(exists || prevIsCompleted),
                                                                    IsMark: !version.IsClosed && (exists || generalInfo.status = VersionSectionState.Completed.Code),
                                                                    IsEnableSendForm: !version.IsReadOnly && version.IsActive && prevIsCompleted && !exists,
                                                                    IsEnableSelectForm: !version.IsReadOnly && version.IsActive && prevIsCompleted && !exists,
                                                                    IsEnableDetails: prevIsCompleted && If(
                                                                        version.IsReadOnly,
                                                                        exists,
                                                                        true
                                                                    ),
                                                                    AdditionalInfo: {
                                                                        IsLoaded: false,
                                                                        Value: AppFunctions.BasicDynamicFieldsStructure
                                                                    }
                                                                }
                                                            ),
                                                            Terms: With(
                                                                {
                                                                    exists: !IsBlank(terms),
                                                                    prevIsCompleted: candidatePersonalInfo.status = VersionSectionState.Completed.Code
                                                                },
                                                                {
                                                                    Exists: exists,
                                                                    Source: terms,
                                                                    Status: If(
                                                                        !exists && prevIsCompleted,
                                                                        VersionSectionState.Opened,
                                                                        AppFunctions.CodeToVersionSectionState(terms.status)
                                                                    ),
                                                                    IsCheck: terms.status = VersionSectionState.Completed.Code,
                                                                    IndicatorState: If(
                                                                        !exists && prevIsCompleted,
                                                                        0,
                                                                        AppFunctions.SectionCodeToComparableValue(terms.status)
                                                                    ),
                                                                    DisplayMode: AppFunctions.BooleanToViewDisplayMode(exists || prevIsCompleted),
                                                                    IsMark: !version.IsClosed && (exists || prevIsCompleted),
                                                                    AdditionalData: {
                                                                        IsLoaded: false,
                                                                        Value: AppFunctions.BasicDynamicFieldsStructure
                                                                    },
                                                                    IsEnableDetails: prevIsCompleted && If(
                                                                        version.IsReadOnly,
                                                                        exists,
                                                                        true
                                                                    )
                                                                }
                                                            ),
                                                            ContractSignature: With(
                                                                {
                                                                    exists: !IsBlank(workflow),
                                                                    prevIsCompleted: terms.status = VersionSectionState.Completed.Code
                                                                },
                                                                {
                                                                    Exists: exists,
                                                                    Source: workflow,
                                                                    Status: If(
                                                                        !exists && prevIsCompleted,
                                                                        WorkflowStatus.Ready,
                                                                        AppFunctions.CodeToWorkflowStatus(workflow.status)
                                                                    ),
                                                                    IsCheck: workflow.status = WorkflowStatus.Sent.Code,
                                                                    IndicatorState: If(
                                                                        !exists && prevIsCompleted,
                                                                        0,
                                                                        AppFunctions.WorkflowCodeToComparableValue(workflow.status)
                                                                    ),
                                                                    DisplayMode: AppFunctions.BooleanToViewDisplayMode(exists || prevIsCompleted),
                                                                    IsMark: !version.IsClosed && (exists || prevIsCompleted),
                                                                    IsEnableSend: GrantAccess.Candidate.JobContract.Launch && version.IsActive && !exists && prevIsCompleted
                                                                }
                                                            ),
                                                            Metadata: {
                                                                IsLoaded: false,
                                                                Value: AppFunctions.MetadataStructure
                                                            }
                                                        }
                                                    ),
                                                    AppFunctions.NotifyError(
                                                        "Error loading job contract data!",
                                                        FirstError.Message
                                                    );
                                                    Blank()
                                                )
                                            }
                                        );
                                        UpdateContext({isLoadingVersion: false});
                                        actLoadMetadata_CandidateScreen.Action()
                                    )
                                Refresh: =Self.OnRefresh()
                                Select: =Self.OnSelect()
                                Title: =$"{timeline_CandidateScreen.Selected.Name} versions"

                        ctnStepInfo_CandidateScreen As groupContainer.horizontalAutoLayoutContainer:
                            BorderColor: =Color.Transparent
                            BorderStyle: =BorderStyle.None
                            Fill: =Color.Transparent
                            FillPortions: =0
                            LayoutAlignItems: =LayoutAlignItems.Stretch
                            LayoutDirection: =LayoutDirection.Vertical
                            LayoutGap: =15
                            LayoutMinHeight: =100
                            LayoutMinWidth: =50
                            LayoutMode: =LayoutMode.Auto
                            PaddingTop: =14
                            Visible: =!IsBlank(version) && !IsEmpty(versions)
                            Width: =250
                            ZIndex: =2

                            ctnVersionActions_CandidateScreen As groupContainer.horizontalAutoLayoutContainer:
                                BorderColor: =Color.Transparent
                                BorderStyle: =BorderStyle.None
                                Fill: =Color.Transparent
                                FillPortions: =0
                                Height: =42
                                LayoutAlignItems: =LayoutAlignItems.Center
                                LayoutGap: =10
                                LayoutJustifyContent: =LayoutJustifyContent.Center
                                LayoutMinHeight: =100
                                LayoutMinWidth: =250
                                LayoutMode: =LayoutMode.Auto
                                RadiusBottomLeft: =4
                                RadiusBottomRight: =4
                                RadiusTopLeft: =4
                                RadiusTopRight: =4
                                ZIndex: =1

                                btnCancelVersion_CandidateScreen As LabeledIconButton:
                                    Enable: =version.IsCancelable
                                    Icon: =Icon.Cancel
                                    LayoutMinHeight: =640
                                    LayoutMinWidth: =640
                                    OnSelect: |-
                                        =UpdateContext(
                                            {
                                                optionDialogModel: AppFunctions.OptionDialogFace(
                                                    $"cancel_version",
                                                    $"Cancel the {processStep.LowerName} version",
                                                    $"Would you like to cancel the filling process for <strong>{version.Source.version}</strong>?<br>This action is not reversible."
                                                )
                                            }
                                        )
                                    RadiusBottonLeft: =Style.RadiusFactor
                                    RadiusBottonRigth: =Style.RadiusFactor
                                    RadiusTopLeft: =Style.RadiusFactor
                                    RadiusTopRigth: =Style.RadiusFactor
                                    Select: |-
                                        =If(
                                            Self.Enable,
                                            Self.OnSelect()
                                        )
                                    Text: ="Cancel"
                                    Tooltip: ="Cancel the current version"
                                    Visible: =true
                                    Width: =78

                                btnShareVersion_CandidateScreen As LabeledIconButton:
                                    Enable: |-
                                        =Switch(
                                            processStep.Code,
                                            DeepScreen.Candidate.JobOffer.Code,
                                            GrantAccess.Candidate.JobOffer.Share,
                                            DeepScreen.Candidate.JobContract.Code,
                                            GrantAccess.Candidate.JobContract.Share
                                        )
                                    Icon: =Icon.Share
                                    LayoutMinHeight: =640
                                    LayoutMinWidth: =640
                                    OnSelect: |-
                                        =With(
                                            version.Source,
                                            UpdateContext(
                                                {
                                                    shareDialogModel: {
                                                        Title: $"Share {processStep.LowerName}: " & version,
                                                        ResourceId: id,
                                                        Param: $"{DeepScreen.Candidate.EntityType}:{candidate.candidateState.id}/{processStep.EntityType}:{id}"
                                                    }
                                                }
                                            )
                                        )
                                    RadiusBottonLeft: =Style.RadiusFactor
                                    RadiusBottonRigth: =Style.RadiusFactor
                                    RadiusTopLeft: =Style.RadiusFactor
                                    RadiusTopRigth: =Style.RadiusFactor
                                    Select: |-
                                        =If(
                                            Self.Enable,
                                            Self.OnSelect()
                                        )
                                    Text: ="Share"
                                    Tooltip: ="Share the current version"
                                    Width: =70
                                    ZIndex: =2

                            dpnVersionInfo_CandidateScreen As DetailsPanel:
                                InternalLateralPadding: =5
                                Items: |-
                                    =Table(
                                        {
                                            Key: "Name",
                                            Value: version.Source.version,
                                            Tooltip: Blank(),
                                            Mark: true,
                                            ShowSeparator: true
                                        },
                                        {
                                            Key: "Template",
                                            Value: version.Source.template.name,
                                            Tooltip: version.Source.template.name,
                                            Mark: true,
                                            ShowSeparator: true
                                        },
                                        {
                                            Key: "Created on",
                                            Value: AppFunctions.FormatDateTimeValue(version.Source.createdOn),
                                            Tooltip: AppFunctions.FormatLongDateTimeValue(version.Source.createdOn),
                                            Mark: true,
                                            ShowSeparator: true
                                        },
                                        {
                                            Key: "Status",
                                            Value: version.Status.Name,
                                            Tooltip: Blank(),
                                            Mark: true,
                                            ShowSeparator: false
                                        }
                                    )
                                KeyAlign: =Align.Right
                                KeyWidth: =80
                                LateralPadding: =5
                                LayoutMinHeight: =640
                                LayoutMinWidth: =50
                                RowHeigth: =32
                                ZIndex: =2

                        ctnVersionVisor_CandidateScreen As groupContainer.manualLayoutContainer:
                            BorderColor: =Color.Transparent
                            BorderStyle: =BorderStyle.None
                            Fill: =Color.Transparent
                            LayoutMinHeight: =100
                            LayoutMinWidth: =250
                            ZIndex: =3

                            ctnVersionContent_CandidateScreen As groupContainer.horizontalAutoLayoutContainer:
                                BorderColor: =Color.Transparent
                                BorderStyle: =BorderStyle.None
                                Fill: =Color.Transparent
                                Height: =Parent.Height
                                LayoutAlignItems: =LayoutAlignItems.Stretch
                                LayoutMode: =LayoutMode.Auto
                                Visible: |-
                                    =Switch(
                                        processStep.Code,
                                        DeepScreen.Candidate.JobOffer.Code,
                                        !IsBlank(jobOfferData),
                                        DeepScreen.Candidate.JobContract.Code,
                                        !IsBlank(jobContractData),
                                        false
                                    )
                                    //true
                                Width: =Parent.Width
                                ZIndex: =1

                                ctnJobOffer_CandidateScreen As groupContainer.verticalAutoLayoutContainer:
                                    BorderColor: =Color.Transparent
                                    BorderStyle: =BorderStyle.None
                                    Fill: =Color.Transparent
                                    LayoutAlignItems: =LayoutAlignItems.Stretch
                                    LayoutDirection: =LayoutDirection.Vertical
                                    LayoutMinHeight: =100
                                    LayoutMinWidth: =250
                                    LayoutMode: =LayoutMode.Auto
                                    LayoutOverflowY: =LayoutOverflow.Scroll
                                    PaddingTop: =15
                                    Visible: =processStep.Code = DeepScreen.Candidate.JobOffer.Code
                                    ZIndex: =2

                                    ctnGeneralInfo_CandidateScreen As groupContainer.horizontalAutoLayoutContainer:
                                        AlignInContainer: =AlignInContainer.SetByContainer
                                        BorderColor: =Color.Transparent
                                        BorderStyle: =BorderStyle.None
                                        Fill: =Color.Transparent
                                        FillPortions: =0
                                        Height: =169
                                        LayoutAlignItems: =LayoutAlignItems.Stretch
                                        LayoutGap: =15
                                        LayoutMinHeight: =100
                                        LayoutMinWidth: =50
                                        LayoutMode: =LayoutMode.Auto
                                        ZIndex: =1

                                        fstGeneralInfoIndicator_CandidateScreen As FlowStep:
                                            Check: =jobOfferData.GeneralInfo.IsCheck
                                            LayoutMinHeight: =25
                                            LayoutMinWidth: =640
                                            State: =jobOfferData.GeneralInfo.IndicatorState
                                            TopBarVisible: =false

                                        ctnGeneralInfoSection_CandidateScreen As groupContainer.verticalAutoLayoutContainer:
                                            AlignInContainer: =AlignInContainer.SetByContainer
                                            BorderColor: =Color.Transparent
                                            BorderStyle: =BorderStyle.None
                                            Fill: =Color.Transparent
                                            LayoutAlignItems: =LayoutAlignItems.Stretch
                                            LayoutDirection: =LayoutDirection.Vertical
                                            LayoutMinHeight: =100
                                            LayoutMinWidth: =250
                                            LayoutMode: =LayoutMode.Auto
                                            ZIndex: =2

                                            ctnGeneralInfoHeader_CandidateScreen As groupContainer.horizontalAutoLayoutContainer:
                                                AlignInContainer: =AlignInContainer.SetByContainer
                                                BorderColor: =Color.Transparent
                                                BorderStyle: =BorderStyle.None
                                                Fill: =Color.Transparent
                                                FillPortions: =0
                                                Height: =32
                                                LayoutAlignItems: =LayoutAlignItems.Stretch
                                                LayoutMinHeight: =100
                                                LayoutMinWidth: =250
                                                LayoutMode: =LayoutMode.Auto
                                                ZIndex: =1

                                                lblGeneralInfo_CandidateScreen As StyledLabel:
                                                    LayoutMinHeight: =30
                                                    LayoutMinWidth: =640
                                                    Mark: =jobOfferData.GeneralInfo.IsMark
                                                    Text: ="General information"
                                                    Width: =175

                                                ctnGeneralInfoInfo_CandidateScreen As groupContainer.horizontalAutoLayoutContainer:
                                                    AlignInContainer: =AlignInContainer.SetByContainer
                                                    BorderColor: =Color.Transparent
                                                    BorderStyle: =BorderStyle.None
                                                    Fill: =Color.Transparent
                                                    LayoutAlignItems: =LayoutAlignItems.Stretch
                                                    LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                                                    LayoutMinHeight: =25
                                                    LayoutMinWidth: =250
                                                    LayoutMode: =LayoutMode.Auto
                                                    PaddingLeft: =10
                                                    ZIndex: =2

                                                    fldGeneralInfoStatus_CandidateScreen As BasicField:
                                                        Default: ="Empty"
                                                        Key: ="Status"
                                                        KeyWidth: =55
                                                        LayoutMinHeight: =17
                                                        LayoutMinWidth: =640
                                                        Mark: =jobOfferData.GeneralInfo.IsMark
                                                        Value: =jobOfferData.GeneralInfo.Status.Name
                                                        Width: =140

                                                    ctnGeneralInfoActions_CandidateScreen As groupContainer.horizontalAutoLayoutContainer:
                                                        AlignInContainer: =AlignInContainer.SetByContainer
                                                        BorderColor: =Color.Transparent
                                                        BorderStyle: =BorderStyle.None
                                                        Fill: =Color.Transparent
                                                        LayoutAlignItems: =LayoutAlignItems.Stretch
                                                        LayoutJustifyContent: =LayoutJustifyContent.End
                                                        LayoutMinHeight: =17
                                                        LayoutMinWidth: =50
                                                        LayoutMode: =LayoutMode.Auto
                                                        ZIndex: =3

                                                        btnEditGeneralInfo_CandidateScreen As LabeledIconButton:
                                                            Align: =Align.Right
                                                            Enable: =jobOfferData.GeneralInfo.EnableEditData
                                                            Icon: |-
                                                                =If(
                                                                    jobOfferData.GeneralInfo.Exists,
                                                                    Icon.Edit,
                                                                    Icon.Add
                                                                )
                                                            LayoutMinHeight: =17
                                                            LayoutMinWidth: =640
                                                            OnSelect: |-
                                                                =UpdateContext(
                                                                    {
                                                                        currentForm: forms.GeneralInfoForm,
                                                                        sheetVisible: true
                                                                    }
                                                                )
                                                            RadiusTopLeft: =Style.RadiusFactor
                                                            Select: |-
                                                                =If(
                                                                    Self.Enable,
                                                                    Self.OnSelect()
                                                                )
                                                            Text: |-
                                                                =If(
                                                                    jobOfferData.GeneralInfo.Exists,
                                                                    "Edit information",
                                                                    "Add information"
                                                                )
                                                            Visible: =true
                                                            Width: =150

                                            shpGeneralInfoHeaderSeparator_CandidateScreen As rectangle:
                                                BorderColor: =Color.Transparent
                                                BorderStyle: =BorderStyle.None
                                                DisplayMode: =DisplayMode.View
                                                Fill: =Style.Palette.Line
                                                FocusedBorderThickness: =0
                                                Height: =1
                                                ZIndex: =2

                                            ctnGeneralInfoControls_CandidateScreen As groupContainer.horizontalAutoLayoutContainer:
                                                AlignInContainer: =AlignInContainer.SetByContainer
                                                BorderColor: =Color.Transparent
                                                BorderStyle: =BorderStyle.None
                                                Fill: =Color.Transparent
                                                LayoutAlignItems: =LayoutAlignItems.Stretch
                                                LayoutDirection: =LayoutDirection.Vertical
                                                LayoutMinHeight: =100
                                                LayoutMinWidth: =250
                                                LayoutMode: =LayoutMode.Auto
                                                PaddingBottom: =15
                                                PaddingTop: =15
                                                ZIndex: =3

                                                ctnGeneralInfoFirstRow_CandidateScreen As groupContainer.verticalAutoLayoutContainer:
                                                    AlignInContainer: =AlignInContainer.SetByContainer
                                                    BorderColor: =Color.Transparent
                                                    BorderStyle: =BorderStyle.None
                                                    Fill: =Color.Transparent
                                                    FillPortions: =0
                                                    Height: =69
                                                    LayoutAlignItems: =LayoutAlignItems.Stretch
                                                    LayoutMinHeight: =25
                                                    LayoutMinWidth: =25
                                                    LayoutMode: =LayoutMode.Auto
                                                    Width: =300
                                                    ZIndex: =1

                                                    ctnGeneralInfoFirstColumn_CandidateScreen As groupContainer.verticalAutoLayoutContainer:
                                                        AlignInContainer: =AlignInContainer.SetByContainer
                                                        LayoutAlignItems: =LayoutAlignItems.Stretch
                                                        LayoutDirection: =LayoutDirection.Vertical
                                                        LayoutGap: =5
                                                        LayoutMinHeight: =25
                                                        LayoutMinWidth: =250
                                                        LayoutMode: =LayoutMode.Auto
                                                        ZIndex: =3

                                                        fldJobOfferDeadlineDate_CandidateScreen As BasicField:
                                                            DisplayMode: =jobOfferData.GeneralInfo.DisplayMode
                                                            Key: ="Deadline date"
                                                            KeyWidth: =130
                                                            LayoutMinWidth: =150
                                                            Mark: =false
                                                            Tooltip: =AppFunctions.FormatLongDateValue(jobOfferData.GeneralInfo.Source.deadlineDate)
                                                            Value: =AppFunctions.FormatDateValue(jobOfferData.GeneralInfo.Source.deadlineDate)

                                                        fldStartOfWork_CandidateScreen As BasicField:
                                                            DisplayMode: =jobOfferData.GeneralInfo.DisplayMode
                                                            Key: ="Start date"
                                                            KeyWidth: =130
                                                            LayoutMinHeight: =640
                                                            LayoutMinWidth: =150
                                                            Mark: =false
                                                            Tooltip: =AppFunctions.FormatLongDateValue(jobOfferData.GeneralInfo.Source.startDate)
                                                            Value: =AppFunctions.FormatDateValue(jobOfferData.GeneralInfo.Source.startDate)
                                                            ZIndex: =2

                                                    ctnGeneralInfoFirstColum_CandidateScreen As groupContainer.verticalAutoLayoutContainer:
                                                        AlignInContainer: =AlignInContainer.SetByContainer
                                                        LayoutAlignItems: =LayoutAlignItems.Stretch
                                                        LayoutDirection: =LayoutDirection.Vertical
                                                        LayoutGap: =5
                                                        LayoutMinHeight: =25
                                                        LayoutMinWidth: =250
                                                        LayoutMode: =LayoutMode.Auto
                                                        ZIndex: =4

                                                        fldJADFIUser_CandidateScreen As BasicField:
                                                            DisplayMode: =jobOfferData.GeneralInfo.DisplayMode
                                                            Key: ="ADFI user"
                                                            KeyWidth: =130
                                                            LayoutMinWidth: =150
                                                            Mark: =false
                                                            Tooltip: =AppFunctions.BuildUserInfo(jobOfferData.GeneralInfo.Source.userADFI)
                                                            Value: =jobOfferData.GeneralInfo.Source.userADFI.name
                                                            Wrap: =false

                                                        fldHumanCapitalUser_CandidateScreen As BasicField:
                                                            DisplayMode: =jobOfferData.GeneralInfo.DisplayMode
                                                            Key: ="Total Rewards user"
                                                            KeyWidth: =130
                                                            LayoutMinHeight: =640
                                                            LayoutMinWidth: =150
                                                            Mark: =false
                                                            Tooltip: =AppFunctions.BuildUserInfo(jobOfferData.GeneralInfo.Source.userHC)
                                                            Value: =jobOfferData.GeneralInfo.Source.userHC.name
                                                            Wrap: =false
                                                            ZIndex: =2

                                                fldWorkingHours_CandidateScreen As BasicField:
                                                    DisplayMode: =jobOfferData.GeneralInfo.DisplayMode
                                                    Key: ="Working hours"
                                                    KeyWidth: =130
                                                    LayoutMinHeight: =640
                                                    LayoutMinWidth: =150
                                                    Mark: =false
                                                    Value: =jobOfferData.GeneralInfo.Source.workingHours
                                                    ZIndex: =2

                                    ctnSalaryPackage_CandidateScreen As groupContainer.horizontalAutoLayoutContainer:
                                        AlignInContainer: =AlignInContainer.SetByContainer
                                        BorderColor: =Color.Transparent
                                        BorderStyle: =BorderStyle.None
                                        Fill: =Color.Transparent
                                        FillPortions: =0
                                        Height: =169
                                        LayoutAlignItems: =LayoutAlignItems.Stretch
                                        LayoutGap: =15
                                        LayoutMinHeight: =100
                                        LayoutMinWidth: =50
                                        LayoutMode: =LayoutMode.Auto
                                        ZIndex: =2

                                        fstSalaryPackageIndicator_CandidateScreen As FlowStep:
                                            Check: =jobOfferData.SalaryPackage.IsCheck
                                            LayoutMinHeight: =25
                                            LayoutMinWidth: =640
                                            State: =jobOfferData.SalaryPackage.IndicatorState

                                        ctnSalaryPackageSection_CandidateScreen As groupContainer.verticalAutoLayoutContainer:
                                            AlignInContainer: =AlignInContainer.SetByContainer
                                            BorderColor: =Color.Transparent
                                            BorderStyle: =BorderStyle.None
                                            Fill: =Color.Transparent
                                            LayoutAlignItems: =LayoutAlignItems.Stretch
                                            LayoutDirection: =LayoutDirection.Vertical
                                            LayoutMinHeight: =100
                                            LayoutMinWidth: =250
                                            LayoutMode: =LayoutMode.Auto
                                            ZIndex: =2

                                            ctnSalaryPackageHeader_CandidateScreen As groupContainer.horizontalAutoLayoutContainer:
                                                AlignInContainer: =AlignInContainer.SetByContainer
                                                BorderColor: =Color.Transparent
                                                BorderStyle: =BorderStyle.None
                                                Fill: =Color.Transparent
                                                FillPortions: =0
                                                Height: =32
                                                LayoutAlignItems: =LayoutAlignItems.Stretch
                                                LayoutMinHeight: =100
                                                LayoutMinWidth: =250
                                                LayoutMode: =LayoutMode.Auto
                                                ZIndex: =1

                                                lblSalaryPackage_CandidateScreen As StyledLabel:
                                                    LayoutMinHeight: =17
                                                    LayoutMinWidth: =640
                                                    Mark: =jobOfferData.SalaryPackage.IsMark
                                                    Text: ="Salary package"
                                                    Width: =175

                                                ctnSalaryPackageInfo_CandidateScreen As groupContainer.horizontalAutoLayoutContainer:
                                                    AlignInContainer: =AlignInContainer.SetByContainer
                                                    BorderColor: =Color.Transparent
                                                    BorderStyle: =BorderStyle.None
                                                    Fill: =Color.Transparent
                                                    LayoutAlignItems: =LayoutAlignItems.Stretch
                                                    LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                                                    LayoutMinHeight: =17
                                                    LayoutMinWidth: =250
                                                    LayoutMode: =LayoutMode.Auto
                                                    PaddingLeft: =10
                                                    ZIndex: =2

                                                    fldSalaryPackageStatus_CandidateScreen As BasicField:
                                                        Default: ="Empty"
                                                        Key: ="Status"
                                                        KeyWidth: =55
                                                        LayoutMinHeight: =17
                                                        LayoutMinWidth: =640
                                                        Mark: =jobOfferData.SalaryPackage.IsMark
                                                        Value: =jobOfferData.SalaryPackage.Status.Name
                                                        Width: =140
                                                        ZIndex: =2

                                                    ctnSalaryPackageActions_CandidateScreen As groupContainer.horizontalAutoLayoutContainer:
                                                        AlignInContainer: =AlignInContainer.SetByContainer
                                                        BorderColor: =Color.Transparent
                                                        BorderStyle: =BorderStyle.None
                                                        Fill: =Color.Transparent
                                                        LayoutAlignItems: =LayoutAlignItems.Stretch
                                                        LayoutJustifyContent: =LayoutJustifyContent.End
                                                        LayoutMinHeight: =17
                                                        LayoutMinWidth: =250
                                                        LayoutMode: =LayoutMode.Auto
                                                        ZIndex: =3

                                                        btnSalaryDetailAccess_CandidateScreen As LabeledIconButton:
                                                            Align: =Align.Right
                                                            Enable: =jobOfferData.SalaryPackage.IsEnableDetailAccess
                                                            EnableChildFocus: =true
                                                            Icon: |-
                                                                =If(
                                                                    version.IsReadOnly,
                                                                    Icon.View,
                                                                    Icon.Edit
                                                                )
                                                            LayoutMinHeight: =17
                                                            LayoutMinWidth: =640
                                                            OnSelect: |-
                                                                =UpdateContext({popLoadVisible: true});
                                                                IfError(
                                                                    With(
                                                                        If(
                                                                            jobOfferData.SalaryPackage.Currencies.IsLoaded,
                                                                            {currencies: jobOfferData.SalaryPackage.Currencies.Value},
                                                                            AppFunctions.ProcessCurrencies(
                                                                                ISignatureAPI.GetCurrencies(),
                                                                                ISignatureAPI.GetTemplateMetadata(version.Source.template.id).currencies
                                                                            )
                                                                        ),
                                                                        Navigate(
                                                                            SalaryPackageScreen,
                                                                            ScreenTransition.None,
                                                                            {
                                                                                version: version.Source,
                                                                                isReadOnly: version.IsReadOnly,
                                                                                isInstantFilling: true,
                                                                                candidate: candidate,
                                                                                jobPosition: jobPosition,
                                                                                salaryPackage: jobOfferData.SalaryPackage.Source,
                                                                                currencies: currencies,
                                                                                financialBreakdownId: jobOfferData.FinancialBreakdown.Source.id
                                                                            }
                                                                        );
                                                                        If(
                                                                            !jobOfferData.SalaryPackage.Currencies.IsLoaded,
                                                                            With(
                                                                                Patch(
                                                                                    jobOfferData,
                                                                                    {
                                                                                        SalaryPackage: Patch(
                                                                                            jobOfferData.SalaryPackage,
                                                                                            {
                                                                                                Currencies: {
                                                                                                    IsLoaded: true,
                                                                                                    Value: currencies
                                                                                                }
                                                                                            }
                                                                                        )
                                                                                    }
                                                                                ),
                                                                                UpdateContext({jobOfferData: ThisRecord})
                                                                            );
                                                                            true
                                                                        )
                                                                    ),
                                                                    AppFunctions.NotifyError(
                                                                        "Error loading template metadata!",
                                                                        FirstError.Message
                                                                    )
                                                                );
                                                                UpdateContext({popLoadVisible: false})
                                                            RadiusTopLeft: =Style.RadiusFactor
                                                            RadiusTopRigth: =Style.RadiusFactor
                                                            Select: |-
                                                                =If(
                                                                    Self.Enable,
                                                                    Self.OnSelect()
                                                                )
                                                            Text: |-
                                                                =If(
                                                                    version.IsReadOnly,
                                                                    "Details",
                                                                    "Assign now"
                                                                )
                                                            Visible: =true
                                                            Width: =115

                                                        btnRequestSalaryPackage_CandidateScreen As LabeledIconButton:
                                                            Align: =Align.Right
                                                            Enable: =jobOfferData.SalaryPackage.IsEnableRequestTo
                                                            Icon: =Icon.ArrowRight
                                                            LayoutMinHeight: =17
                                                            LayoutMinWidth: =640
                                                            OnSelect: |-
                                                                =UpdateContext(
                                                                    {
                                                                        optionDialogModel: AppFunctions.BasicInputDialogFace(
                                                                            "request_salary_assignment",
                                                                            "Salary package filling request",
                                                                            $"Do you want to request salary package details from <strong>{LookUp(
                                                                                jobPosition.hiringManagers,
                                                                                primary
                                                                            ).name}</strong>?",
                                                                            false,
                                                                            "Comments on the request",
                                                                            "",
                                                                            "Request",
                                                                            "Cancel"
                                                                        )
                                                                    }
                                                                )
                                                            RadiusTopLeft: =Style.RadiusFactor
                                                            Select: |-
                                                                =If(
                                                                    Self.Enable,
                                                                    Self.OnSelect()
                                                                )
                                                            Text: ="Request to"
                                                            Visible: =true
                                                            Width: =110
                                                            ZIndex: =2

                                            shpSalaryPackageHeaderSeparator_CandidateScreen As rectangle:
                                                BorderColor: =Color.Transparent
                                                BorderStyle: =BorderStyle.None
                                                DisplayMode: =DisplayMode.View
                                                Fill: =Style.Palette.Line
                                                FocusedBorderThickness: =0
                                                Height: =1
                                                ZIndex: =2

                                            ctnSalaryPackageControls_CandidateScreen As groupContainer.horizontalAutoLayoutContainer:
                                                AlignInContainer: =AlignInContainer.SetByContainer
                                                BorderColor: =Color.Transparent
                                                BorderStyle: =BorderStyle.None
                                                Fill: =Color.Transparent
                                                LayoutAlignItems: =LayoutAlignItems.Stretch
                                                LayoutMinHeight: =100
                                                LayoutMinWidth: =250
                                                LayoutMode: =LayoutMode.Auto
                                                PaddingBottom: =15
                                                PaddingTop: =15
                                                ZIndex: =3

                                                ctnSalaryPackageFirstColumn_CandidateScreen As groupContainer.verticalAutoLayoutContainer:
                                                    AlignInContainer: =AlignInContainer.SetByContainer
                                                    BorderColor: =Color.Transparent
                                                    BorderStyle: =BorderStyle.None
                                                    Fill: =Color.Transparent
                                                    LayoutAlignItems: =LayoutAlignItems.Stretch
                                                    LayoutDirection: =LayoutDirection.Vertical
                                                    LayoutGap: =5
                                                    LayoutMinHeight: =100
                                                    LayoutMinWidth: =25
                                                    LayoutMode: =LayoutMode.Auto
                                                    Width: =300
                                                    ZIndex: =1

                                                    fldAssignedSalary_CandidateScreen As BasicField:
                                                        DisplayMode: =jobOfferData.SalaryPackage.DisplayMode
                                                        Key: ="Assigned salary"
                                                        KeyWidth: =130
                                                        LayoutMinHeight: =640
                                                        LayoutMinWidth: =50
                                                        Mark: =false
                                                        Value: |-
                                                            =If(
                                                                AppFunctions.IsZero(jobOfferData.SalaryPackage.Source.compensation),
                                                                Blank(),
                                                                $"$ {AppFunctions.FormatAmout(jobOfferData.SalaryPackage.Source.compensation)} {jobOfferData.SalaryPackage.Source.currency}"
                                                            )

                                                    fldAssignedBy_CandidateScreen As BasicField:
                                                        DisplayMode: =jobOfferData.SalaryPackage.DisplayMode
                                                        Key: |-
                                                            =If(
                                                                jobOfferData.SalaryPackage.Status.Code = VersionSectionState.Waiting.Code,
                                                                "Requested to",
                                                                "Assigned by"
                                                            )
                                                        KeyWidth: =130
                                                        LayoutMinHeight: =640
                                                        LayoutMinWidth: =50
                                                        Mark: =false
                                                        Tooltip: =AppFunctions.BuildUserInfo(jobOfferData.SalaryPackage.Source.userAssignedBy)
                                                        Value: =jobOfferData.SalaryPackage.Source.userAssignedBy.name
                                                        Wrap: =false
                                                        ZIndex: =2

                                                    fldAssignedAt_CandidateScreen As BasicField:
                                                        DisplayMode: =jobOfferData.SalaryPackage.DisplayMode
                                                        Key: |-
                                                            =If(
                                                                jobOfferData.SalaryPackage.Status.Code = VersionSectionState.Waiting.Code,
                                                                "Requested on",
                                                                "Assigned on"
                                                            )
                                                        KeyWidth: =130
                                                        LayoutMinHeight: =640
                                                        LayoutMinWidth: =50
                                                        Mark: =false
                                                        Tooltip: =AppFunctions.FormatLongDateTimeValue(jobOfferData.SalaryPackage.Source.modifiedOn)
                                                        Value: =AppFunctions.FormatDateTimeValue(jobOfferData.SalaryPackage.Source.modifiedOn)
                                                        ZIndex: =3

                                                ctnSalaryPackageSecondColumn_CandidateScreen As groupContainer.verticalAutoLayoutContainer:
                                                    AlignInContainer: =AlignInContainer.SetByContainer
                                                    LayoutAlignItems: =LayoutAlignItems.Stretch
                                                    LayoutDirection: =LayoutDirection.Vertical
                                                    LayoutGap: =5
                                                    LayoutMinHeight: =100
                                                    LayoutMinWidth: =25
                                                    LayoutMode: =LayoutMode.Auto
                                                    Width: =300
                                                    ZIndex: =2

                                                    fldLastUpdateBySalaryPackage_CandidateScreen As BasicField:
                                                        DisplayMode: =jobOfferData.SalaryPackage.DisplayMode
                                                        Key: |-
                                                            =If(
                                                                jobOfferData.SalaryPackage.Status.Code = VersionSectionState.Waiting.Code,
                                                                "Requested by",
                                                                "Last updated by"
                                                            )
                                                        KeyWidth: =130
                                                        LayoutMinHeight: =640
                                                        LayoutMinWidth: =50
                                                        Mark: =false
                                                        Tooltip: =AppFunctions.BuildUserInfo( jobOfferData.SalaryPackage.Source.userLastUpdatedBy)
                                                        Value: =jobOfferData.SalaryPackage.Source.userLastUpdatedBy.name
                                                        Wrap: =false

                                    ctnFinancialBreakdown_CandidateScreen As groupContainer.horizontalAutoLayoutContainer:
                                        AlignInContainer: =AlignInContainer.SetByContainer
                                        BorderColor: =Color.Transparent
                                        BorderStyle: =BorderStyle.None
                                        Fill: =Color.Transparent
                                        FillPortions: =0
                                        Height: =169
                                        LayoutAlignItems: =LayoutAlignItems.Stretch
                                        LayoutGap: =15
                                        LayoutMinHeight: =100
                                        LayoutMinWidth: =50
                                        LayoutMode: =LayoutMode.Auto
                                        ZIndex: =3

                                        fstFinancialBreakdownIndicator_CandidateScreen As FlowStep:
                                            Check: =jobOfferData.FinancialBreakdown.IsCheck
                                            LayoutMinHeight: =25
                                            LayoutMinWidth: =640
                                            State: =jobOfferData.FinancialBreakdown.IndicatorState

                                        ctnFinancialBreakdownSection_CandidateScreen As groupContainer.verticalAutoLayoutContainer:
                                            AlignInContainer: =AlignInContainer.SetByContainer
                                            BorderColor: =Color.Transparent
                                            BorderStyle: =BorderStyle.None
                                            Fill: =Color.Transparent
                                            LayoutAlignItems: =LayoutAlignItems.Stretch
                                            LayoutDirection: =LayoutDirection.Vertical
                                            LayoutMinHeight: =100
                                            LayoutMinWidth: =250
                                            LayoutMode: =LayoutMode.Auto
                                            ZIndex: =2

                                            ctnFinancialBreakdownHeader_CandidateScreen As groupContainer.horizontalAutoLayoutContainer:
                                                AlignInContainer: =AlignInContainer.SetByContainer
                                                BorderColor: =Color.Transparent
                                                BorderStyle: =BorderStyle.None
                                                Fill: =Color.Transparent
                                                FillPortions: =0
                                                Height: =32
                                                LayoutAlignItems: =LayoutAlignItems.Stretch
                                                LayoutMinHeight: =100
                                                LayoutMinWidth: =250
                                                LayoutMode: =LayoutMode.Auto
                                                ZIndex: =1

                                                lblFinancialBreakdown_CandidateScreen As StyledLabel:
                                                    LayoutMinHeight: =30
                                                    LayoutMinWidth: =640
                                                    Mark: =jobOfferData.FinancialBreakdown.IsMark
                                                    Text: ="Financial breakdown"
                                                    Width: =175

                                                ctnFinancialBreakdownInfo_CandidateScreen As groupContainer.horizontalAutoLayoutContainer:
                                                    AlignInContainer: =AlignInContainer.SetByContainer
                                                    BorderColor: =Color.Transparent
                                                    BorderStyle: =BorderStyle.None
                                                    Fill: =Color.Transparent
                                                    LayoutAlignItems: =LayoutAlignItems.Stretch
                                                    LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                                                    LayoutMinHeight: =17
                                                    LayoutMinWidth: =250
                                                    LayoutMode: =LayoutMode.Auto
                                                    PaddingLeft: =10
                                                    ZIndex: =2

                                                    fldFinancialBreakdownStatus_CandidateScreen As BasicField:
                                                        Default: ="Empty"
                                                        Key: ="Status"
                                                        KeyWidth: =55
                                                        LayoutMinHeight: =17
                                                        LayoutMinWidth: =640
                                                        Mark: =jobOfferData.FinancialBreakdown.IsMark
                                                        Value: =jobOfferData.FinancialBreakdown.Status.Name
                                                        Width: =140
                                                        ZIndex: =2

                                                    ctnFinancialBreakdownActions_CandidateScreen As groupContainer.horizontalAutoLayoutContainer:
                                                        AlignInContainer: =AlignInContainer.SetByContainer
                                                        LayoutAlignItems: =LayoutAlignItems.Stretch
                                                        LayoutJustifyContent: =LayoutJustifyContent.End
                                                        LayoutMinHeight: =17
                                                        LayoutMinWidth: =25
                                                        LayoutMode: =LayoutMode.Auto
                                                        ZIndex: =3

                                                        btnBreakdownDetailAccess_CandidateScreen As LabeledIconButton:
                                                            Align: =Align.Right
                                                            Enable: =jobOfferData.FinancialBreakdown.IsEnableDetailAccess
                                                            Icon: |-
                                                                =If(
                                                                    version.IsReadOnly,
                                                                    Icon.View,
                                                                    Icon.Document
                                                                )
                                                            LayoutMinHeight: =17
                                                            LayoutMinWidth: =640
                                                            OnSelect: |-
                                                                =UpdateContext({popLoadVisible: true});
                                                                IfError(
                                                                    With(
                                                                        {
                                                                            breakdown: If(
                                                                                jobOfferData.FinancialBreakdown.Breakdown.IsLoaded,
                                                                                jobOfferData.FinancialBreakdown.Breakdown.Value,
                                                                                AppFunctions.ProcessDynamicFields(
                                                                                    If(
                                                                                        IsBlank(jobOfferData.FinancialBreakdown.Source.content),
                                                                                        ISignatureAPI.GetTemplateDynamicFields(version.Source.template.id),
                                                                                        AppFunctions.ParseDynamicFields(jobOfferData.FinancialBreakdown.Source.content)
                                                                                    )
                                                                                )
                                                                            )
                                                                        },
                                                                        UpdateContext({popLoadVisible: false});
                                                                        If(
                                                                            !IsError(breakdown),
                                                                            If(
                                                                                !jobOfferData.FinancialBreakdown.Breakdown.IsLoaded,
                                                                                UpdateContext(
                                                                                    {
                                                                                        jobOfferData: Patch(
                                                                                            jobOfferData,
                                                                                            {
                                                                                                FinancialBreakdown: Patch(
                                                                                                    jobOfferData.FinancialBreakdown,
                                                                                                    {
                                                                                                        Breakdown: {
                                                                                                            IsLoaded: true,
                                                                                                            Value: breakdown
                                                                                                        }
                                                                                                    }
                                                                                                )
                                                                                            }
                                                                                        )
                                                                                    }
                                                                                )
                                                                            );
                                                                            If(
                                                                                !IsEmpty(breakdown) || version.IsReadOnly,
                                                                                Navigate(
                                                                                    FinancialBreakdownScreen,
                                                                                    ScreenTransition.None,
                                                                                    {
                                                                                        version: version.Source,
                                                                                        isInstantFilling: true,
                                                                                        isEditValues: true,
                                                                                        isReadOnly: version.IsReadOnly,
                                                                                        candidate: candidate,
                                                                                        jobPosition: jobPosition,
                                                                                        salaryPackage: jobOfferData.SalaryPackage.Source,
                                                                                        financialBreakdown: jobOfferData.FinancialBreakdown.Source,
                                                                                        breakdown: breakdown
                                                                                    }
                                                                                ),
                                                                                UpdateContext(
                                                                                    {
                                                                                        optionDialogModel: AppFunctions.OptionDialogFace(
                                                                                            "fill_breakdown",
                                                                                            "Fill breakdown",
                                                                                            $"This template has no breakdown. The filling will be done directly with the following data:
                                                                                                <br>
                                                                                                <ul>
                                                                                                    <li><strong>Gross salary: </strong> {AppFunctions.FormatAmout(jobOfferData.SalaryPackage.Source.compensation)}</li>
                                                                                                    <li><strong>Daily salary: </strong>{AppFunctions.FormatAmout(jobOfferData.SalaryPackage.Source.compensation / 30.4)}</li>
                                                                                                    <li><strong>Monthly salary: </strong>{AppFunctions.FormatAmout(jobOfferData.SalaryPackage.Source.compensation)}</li>
                                                                                                </ul>
                                                                                            ",
                                                                                            "Continue",
                                                                                            "Cancel",
                                                                                            500,
                                                                                            300
                                                                                        )
                                                                                    }
                                                                                )
                                                                            )
                                                                        );
                                                                        breakdown
                                                                    ),
                                                                    AppFunctions.NotifyError(
                                                                        "Error loading breakdown structure!",
                                                                        FirstError.Message
                                                                    )
                                                                )
                                                            RadiusTopLeft: =Style.RadiusFactor
                                                            RadiusTopRigth: =Style.RadiusFactor
                                                            Select: |-
                                                                =If(
                                                                    Self.Enable,
                                                                    Self.OnSelect()
                                                                )
                                                            Text: |-
                                                                =If(
                                                                    version.IsReadOnly,
                                                                    "Details",
                                                                    "Fill now"
                                                                )
                                                            Visible: =true
                                                            Width: =85

                                                        btnRequestBreakdown_CandidateScreen As LabeledIconButton:
                                                            Align: =Align.Right
                                                            Enable: =jobOfferData.FinancialBreakdown.IsEnableRequestTo
                                                            Icon: =Icon.ArrowRight
                                                            LayoutMinHeight: =17
                                                            LayoutMinWidth: =640
                                                            OnSelect: |-
                                                                =UpdateContext(
                                                                    {
                                                                        optionDialogModel: AppFunctions.OptionDialogFace(
                                                                            "request_breakdown",
                                                                            "Request breakdown",
                                                                            $"Do you want to request the filling of the financial breakdown from <strong>{jobOfferData.GeneralInfo.Source.userADFI.name}</strong>?",
                                                                            "Request",
                                                                            "Cancel"
                                                                        )
                                                                    }
                                                                )
                                                            RadiusTopLeft: =Style.RadiusFactor
                                                            Select: |-
                                                                =If(
                                                                    Self.Enable,
                                                                    Self.OnSelect()
                                                                )
                                                            Text: ="Request to"
                                                            Visible: =true
                                                            Width: =110
                                                            ZIndex: =2

                                            shpFinancialBreakdownHeaderSeparator_CandidateScreen As rectangle:
                                                BorderColor: =Color.Transparent
                                                BorderStyle: =BorderStyle.None
                                                DisplayMode: =DisplayMode.View
                                                Fill: =Style.Palette.Line
                                                FocusedBorderThickness: =0
                                                Height: =1
                                                ZIndex: =2

                                            ctnFinancialBreakdownControls_CandidateScreen As groupContainer.horizontalAutoLayoutContainer:
                                                AlignInContainer: =AlignInContainer.SetByContainer
                                                BorderColor: =Color.Transparent
                                                BorderStyle: =BorderStyle.None
                                                Fill: =Color.Transparent
                                                LayoutAlignItems: =LayoutAlignItems.Stretch
                                                LayoutMinHeight: =100
                                                LayoutMinWidth: =250
                                                LayoutMode: =LayoutMode.Auto
                                                PaddingBottom: =15
                                                PaddingTop: =15
                                                ZIndex: =3

                                                ctnFinancialBreakdownFirstColumn_CandidateScreen As groupContainer.verticalAutoLayoutContainer:
                                                    AlignInContainer: =AlignInContainer.SetByContainer
                                                    BorderColor: =Color.Transparent
                                                    BorderStyle: =BorderStyle.None
                                                    Fill: =Color.Transparent
                                                    LayoutAlignItems: =LayoutAlignItems.Stretch
                                                    LayoutDirection: =LayoutDirection.Vertical
                                                    LayoutGap: =5
                                                    LayoutMinHeight: =100
                                                    LayoutMinWidth: =25
                                                    LayoutMode: =LayoutMode.Auto
                                                    Width: =300
                                                    ZIndex: =1

                                                    fldFilledBy_CandidateScreen As BasicField:
                                                        Default: ="Not  specified"
                                                        DisplayMode: =jobOfferData.FinancialBreakdown.DisplayMode
                                                        Key: |-
                                                            =If(
                                                                jobOfferData.FinancialBreakdown.Status.Code = VersionSectionState.Waiting.Code,
                                                                "Requested to",
                                                                "Filled by"
                                                            )
                                                        KeyWidth: =130
                                                        LayoutMinHeight: =640
                                                        LayoutMinWidth: =50
                                                        Mark: =false
                                                        Tooltip: =AppFunctions.BuildUserInfo(jobOfferData.FinancialBreakdown.Source.userFilledBy)
                                                        Value: =jobOfferData.FinancialBreakdown.Source.userFilledBy.name
                                                        Wrap: =false

                                                    fldFilledAt_CandidateScreen As BasicField:
                                                        DisplayMode: =jobOfferData.FinancialBreakdown.DisplayMode
                                                        Key: |-
                                                            =If(
                                                                jobOfferData.FinancialBreakdown.Status.Code = VersionSectionState.Waiting.Code,
                                                                "Requested on",
                                                                "Filled on"
                                                            )
                                                        KeyWidth: =130
                                                        LayoutMinHeight: =640
                                                        LayoutMinWidth: =50
                                                        Mark: =false
                                                        Tooltip: =AppFunctions.FormatLongDateTimeValue(jobOfferData.FinancialBreakdown.Source.modifiedOn)
                                                        Value: =AppFunctions.FormatDateTimeValue(jobOfferData.FinancialBreakdown.Source.modifiedOn)
                                                        ZIndex: =2

                                                    fldLastUpdatedByFinancialBreakdown_CandidateScreen As BasicField:
                                                        DisplayMode: =jobOfferData.FinancialBreakdown.DisplayMode
                                                        Key: |-
                                                            =If(
                                                                jobOfferData.FinancialBreakdown.Status.Code = VersionSectionState.Waiting.Code,
                                                                "Requested by",
                                                                "Last updated by"
                                                            )
                                                        KeyWidth: =130
                                                        LayoutMinHeight: =640
                                                        LayoutMinWidth: =50
                                                        Mark: =false
                                                        Tooltip: =AppFunctions.BuildUserInfo(jobOfferData.FinancialBreakdown.Source.userLastUpdatedBy)
                                                        Value: =jobOfferData.FinancialBreakdown.Source.userLastUpdatedBy.name
                                                        Wrap: =false
                                                        ZIndex: =3

                                                ctnFinancialBreakdownSecondColumn_CandidateScreen As groupContainer.verticalAutoLayoutContainer:
                                                    AlignInContainer: =AlignInContainer.SetByContainer
                                                    BorderColor: =Color.Transparent
                                                    BorderStyle: =BorderStyle.None
                                                    Fill: =Color.Transparent
                                                    LayoutAlignItems: =LayoutAlignItems.Stretch
                                                    LayoutDirection: =LayoutDirection.Vertical
                                                    LayoutGap: =5
                                                    LayoutMinHeight: =100
                                                    LayoutMinWidth: =25
                                                    LayoutMode: =LayoutMode.Auto
                                                    Width: =300
                                                    ZIndex: =2

                                                    fldGrossSalary_CandidateScreen As BasicField:
                                                        DisplayMode: =jobOfferData.FinancialBreakdown.DisplayMode
                                                        Key: ="Gross salary"
                                                        KeyWidth: =130
                                                        LayoutMinHeight: =640
                                                        LayoutMinWidth: =50
                                                        Mark: =false
                                                        Value: |-
                                                            =If(
                                                                AppFunctions.IsZero(jobOfferData.FinancialBreakdown.Source.grossSalary),
                                                                Blank(),
                                                                $"$ {AppFunctions.FormatAmout(jobOfferData.FinancialBreakdown.Source.grossSalary)} {jobOfferData.SalaryPackage.Source.currency}"
                                                            )
                                                        ZIndex: =2

                                                    fldDailySalary_CandidateScreen As BasicField:
                                                        DisplayMode: =jobOfferData.FinancialBreakdown.DisplayMode
                                                        Key: ="Daily salary"
                                                        KeyWidth: =130
                                                        LayoutMinHeight: =640
                                                        LayoutMinWidth: =50
                                                        Mark: =false
                                                        Value: |-
                                                            =If(
                                                                AppFunctions.IsZero(jobOfferData.FinancialBreakdown.Source.dailySalary),
                                                                Blank(),
                                                                $"$ {AppFunctions.FormatAmout(jobOfferData.FinancialBreakdown.Source.dailySalary)} {jobOfferData.SalaryPackage.Source.currency}"
                                                            )
                                                        ZIndex: =3

                                                    fldMonthlySalary_CandidateScreen As BasicField:
                                                        DisplayMode: =jobOfferData.FinancialBreakdown.DisplayMode
                                                        Key: ="Monthly salary"
                                                        KeyWidth: =130
                                                        LayoutMinHeight: =640
                                                        LayoutMinWidth: =50
                                                        Mark: =false
                                                        Value: |-
                                                            =If(
                                                                AppFunctions.IsZero(jobOfferData.FinancialBreakdown.Source.monthlySalary),
                                                                Blank(),
                                                                $"$ {AppFunctions.FormatAmout(jobOfferData.FinancialBreakdown.Source.monthlySalary)} {jobOfferData.SalaryPackage.Source.currency}"
                                                            )
                                                        ZIndex: =4

                                    ctnOfferSignature_CandidateScreen As groupContainer.horizontalAutoLayoutContainer:
                                        AlignInContainer: =AlignInContainer.SetByContainer
                                        BorderColor: =Color.Transparent
                                        BorderStyle: =BorderStyle.None
                                        Fill: =Color.Transparent
                                        FillPortions: =0
                                        Height: =169
                                        LayoutAlignItems: =LayoutAlignItems.Stretch
                                        LayoutGap: =15
                                        LayoutMinHeight: =100
                                        LayoutMinWidth: =50
                                        LayoutMode: =LayoutMode.Auto
                                        ZIndex: =4

                                        fstOfferSignatureIndicator_CandidateScreen As FlowStep:
                                            BottomBarVisible: =false
                                            Check: =jobOfferData.OfferSignature.IsCheck
                                            LayoutMinHeight: =25
                                            LayoutMinWidth: =640
                                            State: =jobOfferData.OfferSignature.IndicatorState

                                        ctnOfferSignatureSection_CandidateScreen As groupContainer.verticalAutoLayoutContainer:
                                            AlignInContainer: =AlignInContainer.SetByContainer
                                            BorderColor: =Color.Transparent
                                            BorderStyle: =BorderStyle.None
                                            Fill: =Color.Transparent
                                            LayoutAlignItems: =LayoutAlignItems.Stretch
                                            LayoutDirection: =LayoutDirection.Vertical
                                            LayoutMinHeight: =100
                                            LayoutMinWidth: =250
                                            LayoutMode: =LayoutMode.Auto
                                            ZIndex: =2

                                            ctnOfferSignatureHeader_CandidateScreen As groupContainer.horizontalAutoLayoutContainer:
                                                AlignInContainer: =AlignInContainer.SetByContainer
                                                BorderColor: =Color.Transparent
                                                BorderStyle: =BorderStyle.None
                                                Fill: =Color.Transparent
                                                FillPortions: =0
                                                Height: =32
                                                LayoutAlignItems: =LayoutAlignItems.Stretch
                                                LayoutMinHeight: =100
                                                LayoutMinWidth: =250
                                                LayoutMode: =LayoutMode.Auto
                                                ZIndex: =1

                                                lblOfferSignature_CandidateScreen As StyledLabel:
                                                    LayoutMinHeight: =17
                                                    LayoutMinWidth: =640
                                                    Mark: =jobOfferData.OfferSignature.IsMark
                                                    Text: ="Signing of job offer"
                                                    Width: =175

                                                ctnOfferSignatureInfo_CandidateScreen As groupContainer.horizontalAutoLayoutContainer:
                                                    AlignInContainer: =AlignInContainer.SetByContainer
                                                    BorderColor: =Color.Transparent
                                                    BorderStyle: =BorderStyle.None
                                                    Fill: =Color.Transparent
                                                    LayoutAlignItems: =LayoutAlignItems.Stretch
                                                    LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                                                    LayoutMinHeight: =17
                                                    LayoutMinWidth: =250
                                                    LayoutMode: =LayoutMode.Auto
                                                    PaddingLeft: =10
                                                    ZIndex: =2

                                                    fldOfferSignatureStatus_CandidateScreen As BasicField:
                                                        Default: ="Empty"
                                                        Key: ="Status"
                                                        KeyWidth: =55
                                                        LayoutMinHeight: =17
                                                        LayoutMinWidth: =640
                                                        Mark: =jobOfferData.OfferSignature.IsMark
                                                        Value: =jobOfferData.OfferSignature.Status.Name
                                                        Width: =140
                                                        ZIndex: =2

                                                    ctnOfferSignatureActions_CandidateScreen As groupContainer.horizontalAutoLayoutContainer:
                                                        AlignInContainer: =AlignInContainer.SetByContainer
                                                        LayoutAlignItems: =LayoutAlignItems.Stretch
                                                        LayoutJustifyContent: =LayoutJustifyContent.End
                                                        LayoutMinHeight: =17
                                                        LayoutMinWidth: =25
                                                        LayoutMode: =LayoutMode.Auto
                                                        ZIndex: =3

                                                        btnSendOfferForSignature_CandidateScreen As LabeledIconButton:
                                                            Align: =Align.Right
                                                            Enable: =jobOfferData.OfferSignature.IsEnableSend
                                                            Icon: =Icon.Send
                                                            LayoutMinHeight: =17
                                                            LayoutMinWidth: =640
                                                            OnSelect: |-
                                                                =UpdateContext(
                                                                    {
                                                                        optionDialogModel: AppFunctions.OptionDialogFace(
                                                                            "send_job_offer",
                                                                            "Send for signature",
                                                                            $"Send job offer to <strong>{candidate.candidateState.candidateInfo.fullName}</strong>?",
                                                                            "Send",
                                                                            "Cancel"
                                                                        )
                                                                    }
                                                                )
                                                            RadiusTopLeft: =Style.RadiusFactor
                                                            Select: |-
                                                                =If(
                                                                    Self.Enable,
                                                                    Self.OnSelect()
                                                                )
                                                            Text: ="Send for signature"
                                                            Visible: =true
                                                            Width: =150

                                            shpOfferSignatureHeaderSeparator_CandidateScreen As rectangle:
                                                BorderColor: =Color.Transparent
                                                BorderStyle: =BorderStyle.None
                                                DisplayMode: =DisplayMode.View
                                                Fill: =Style.Palette.Line
                                                FocusedBorderThickness: =0
                                                Height: =1
                                                ZIndex: =2

                                            ctnOfferSignatureControls_CandidateScreen As groupContainer.horizontalAutoLayoutContainer:
                                                AlignInContainer: =AlignInContainer.SetByContainer
                                                BorderColor: =Color.Transparent
                                                BorderStyle: =BorderStyle.None
                                                Fill: =Color.Transparent
                                                LayoutAlignItems: =LayoutAlignItems.Stretch
                                                LayoutDirection: =LayoutDirection.Vertical
                                                LayoutMinHeight: =100
                                                LayoutMinWidth: =250
                                                LayoutMode: =LayoutMode.Auto
                                                PaddingBottom: =15
                                                PaddingTop: =15
                                                ZIndex: =3

                                                ctnOfferSignatureTopRow_CandidateScreen As groupContainer.horizontalAutoLayoutContainer:
                                                    BorderColor: =Color.Transparent
                                                    BorderStyle: =BorderStyle.None
                                                    Fill: =Color.Transparent
                                                    FillPortions: =0
                                                    Height: =32
                                                    LayoutAlignItems: =LayoutAlignItems.Stretch
                                                    LayoutMinHeight: =100
                                                    LayoutMinWidth: =250
                                                    LayoutMode: =LayoutMode.Auto
                                                    ZIndex: =1

                                                    fldSentOfferAt_CandidateScreen As BasicField:
                                                        DisplayMode: =jobOfferData.OfferSignature.DisplayMode
                                                        FillPortions: =1
                                                        Key: ="Send at"
                                                        KeyWidth: =130
                                                        LayoutMinHeight: =25
                                                        LayoutMinWidth: =25
                                                        Mark: =false
                                                        Tooltip: =AppFunctions.FormatLongDateTimeValue(jobOfferData.OfferSignature.Source.createdOn)
                                                        Value: =AppFunctions.FormatDateTimeValue(jobOfferData.OfferSignature.Source.createdOn)

                                                    fldUpdatedOfferAt_CandidateScreen As BasicField:
                                                        DisplayMode: =jobOfferData.OfferSignature.DisplayMode
                                                        FillPortions: =1
                                                        Key: ="Updated At"
                                                        KeyWidth: =130
                                                        LayoutMinHeight: =25
                                                        LayoutMinWidth: =25
                                                        Mark: =false
                                                        Tooltip: =AppFunctions.FormatLongDateTimeValue(jobOfferData.OfferSignature.Source.modifiedOn)
                                                        Value: =AppFunctions.FormatDateTimeValue(jobOfferData.OfferSignature.Source.modifiedOn)
                                                        ZIndex: =2

                                                ctnOfferSignatureButtomRow_CandidateScreen As groupContainer.verticalAutoLayoutContainer:
                                                    AlignInContainer: =AlignInContainer.SetByContainer
                                                    BorderColor: =Color.Transparent
                                                    BorderStyle: =BorderStyle.None
                                                    Fill: =Color.Transparent
                                                    FillPortions: =0
                                                    Height: =32
                                                    LayoutAlignItems: =LayoutAlignItems.Stretch
                                                    LayoutDirection: =LayoutDirection.Vertical
                                                    LayoutGap: =5
                                                    LayoutMinHeight: =100
                                                    LayoutMinWidth: =25
                                                    LayoutMode: =LayoutMode.Auto
                                                    Width: =300
                                                    ZIndex: =2

                                                    fldOfferMessage_CandidateScreen As BasicField:
                                                        DisplayMode: =jobOfferData.OfferSignature.DisplayMode
                                                        Key: ="Message"
                                                        KeyWidth: =130
                                                        LayoutMinHeight: =640
                                                        LayoutMinWidth: =640
                                                        Mark: =false
                                                        Value: |-
                                                            =If(
                                                                IsBlank(jobOfferData.OfferSignature.Source.message),
                                                                "Waiting for status update",
                                                                jobOfferData.OfferSignature.Source.message
                                                            )
                                                        Visible: =true

                                ctnJobContract_CandidateScreen As groupContainer.verticalAutoLayoutContainer:
                                    AlignInContainer: =AlignInContainer.SetByContainer
                                    BorderColor: =Color.Transparent
                                    BorderStyle: =BorderStyle.None
                                    Fill: =Color.Transparent
                                    LayoutAlignItems: =LayoutAlignItems.Stretch
                                    LayoutDirection: =LayoutDirection.Vertical
                                    LayoutMinHeight: =100
                                    LayoutMinWidth: =250
                                    LayoutMode: =LayoutMode.Auto
                                    LayoutOverflowY: =LayoutOverflow.Scroll
                                    PaddingTop: =15
                                    Visible: =processStep.Code = DeepScreen.Candidate.JobContract.Code
                                    ZIndex: =3

                                    ctnJobContractInfo_CandidateScreen As groupContainer.horizontalAutoLayoutContainer:
                                        AlignInContainer: =AlignInContainer.SetByContainer
                                        BorderColor: =Color.Transparent
                                        BorderStyle: =BorderStyle.None
                                        Fill: =Color.Transparent
                                        FillPortions: =0
                                        Height: =206
                                        LayoutAlignItems: =LayoutAlignItems.Stretch
                                        LayoutGap: =15
                                        LayoutMinHeight: =100
                                        LayoutMinWidth: =50
                                        LayoutMode: =LayoutMode.Auto
                                        ZIndex: =1

                                        fstPositionIndicator_CandidateScreen As FlowStep:
                                            Check: =jobContractData.GeneralInfo.IsCheck
                                            LayoutMinHeight: =25
                                            LayoutMinWidth: =640
                                            State: =jobContractData.GeneralInfo.IndicatorState
                                            TopBarVisible: =false

                                        ctnJobContractInfoSection_CandidateScreen As groupContainer.verticalAutoLayoutContainer:
                                            AlignInContainer: =AlignInContainer.SetByContainer
                                            BorderColor: =Color.Transparent
                                            BorderStyle: =BorderStyle.None
                                            Fill: =Color.Transparent
                                            LayoutAlignItems: =LayoutAlignItems.Stretch
                                            LayoutDirection: =LayoutDirection.Vertical
                                            LayoutMinHeight: =100
                                            LayoutMinWidth: =250
                                            LayoutMode: =LayoutMode.Auto
                                            ZIndex: =2

                                            ctnJobContractInfoHeader_CandidateScreen As groupContainer.horizontalAutoLayoutContainer:
                                                AlignInContainer: =AlignInContainer.SetByContainer
                                                BorderColor: =Color.Transparent
                                                BorderStyle: =BorderStyle.None
                                                Fill: =Color.Transparent
                                                FillPortions: =0
                                                Height: =32
                                                LayoutAlignItems: =LayoutAlignItems.Stretch
                                                LayoutMinHeight: =100
                                                LayoutMinWidth: =250
                                                LayoutMode: =LayoutMode.Auto
                                                ZIndex: =1

                                                lblJobContractInfo_CandidateScreen As StyledLabel:
                                                    LayoutMinHeight: =25
                                                    LayoutMinWidth: =640
                                                    Mark: =jobContractData.GeneralInfo.IsMark
                                                    Text: ="General info"
                                                    Width: =175

                                                ctnJobContractInfoInfo_CandidateScreen As groupContainer.horizontalAutoLayoutContainer:
                                                    AlignInContainer: =AlignInContainer.SetByContainer
                                                    BorderColor: =Color.Transparent
                                                    BorderStyle: =BorderStyle.None
                                                    Fill: =Color.Transparent
                                                    LayoutAlignItems: =LayoutAlignItems.Stretch
                                                    LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                                                    LayoutMinHeight: =25
                                                    LayoutMinWidth: =250
                                                    LayoutMode: =LayoutMode.Auto
                                                    PaddingLeft: =10
                                                    ZIndex: =2

                                                    fldJobContractInfoStatus_CandidateScreen As BasicField:
                                                        Key: ="Status"
                                                        KeyWidth: =55
                                                        LayoutMinHeight: =25
                                                        LayoutMinWidth: =640
                                                        Mark: =jobContractData.GeneralInfo.IsMark
                                                        Value: =jobContractData.GeneralInfo.Status.Name
                                                        Width: =140

                                                    ctnJobContractInfoActions_CandidateScreen As groupContainer.horizontalAutoLayoutContainer:
                                                        AlignInContainer: =AlignInContainer.SetByContainer
                                                        BorderColor: =Color.Transparent
                                                        BorderStyle: =BorderStyle.None
                                                        Fill: =Color.Transparent
                                                        LayoutAlignItems: =LayoutAlignItems.Stretch
                                                        LayoutJustifyContent: =LayoutJustifyContent.End
                                                        LayoutMinHeight: =25
                                                        LayoutMinWidth: =250
                                                        LayoutMode: =LayoutMode.Auto
                                                        ZIndex: =2

                                                        btnJobContractInfoDetails_CandidateScreen As LabeledIconButton:
                                                            Align: =Align.Right
                                                            Icon: |-
                                                                =If(
                                                                    jobContractData.GeneralInfo.Exists,
                                                                    Icon.View,
                                                                    Icon.Edit
                                                                )
                                                            LayoutMinHeight: =25
                                                            LayoutMinWidth: =640
                                                            OnSelect: |-
                                                                =/*UpdateContext({popLoadVisible: true});;
                                                                IfError(
                                                                    With(
                                                                        jobContractData.Position;
                                                                        With(
                                                                            AppFunctions.LoadSignedOffers(candidate.candidateState.id);
                                                                            With(
                                                                                If(
                                                                                    Exists;
                                                                                    ISignatureAPI.GetJobOfferVersion(Source.jobOffer.id);
                                                                                    With(
                                                                                        First(SignedOffers);
                                                                                        ISignatureAPI.GetJobOfferVersion(id)
                                                                                    )
                                                                                ) As fullJobOffer;
                                                                                Navigate(
                                                                                    FormScreen;
                                                                                    ScreenTransition.None;
                                                                                    {
                                                                                        deepScreen: DeepScreen.Candidate.JobContract.Position;
                                                                                        isReadOnly: version.IsReadOnly;
                                                                                        isEditValues: !Exists;
                                                                                        enableFooter: !Exists;
                                                                                        formMode: AppFunctions.BooleanToFormMode(Exists);
                                                                                        version: version.Source;
                                                                                        jobPosition: jobPosition;
                                                                                        candidate: candidate.candidateState;
                                                                                        staticContent: Patch(
                                                                                            Source;
                                                                                            {
                                                                                                jobOffer: fullJobOffer.jobOffer;
                                                                                                workingHours: AppFunctions.CommonWorkingHours
                                                                                            }
                                                                                        );
                                                                                        dynamicContent: Blank();
                                                                                        clients: If(
                                                                                            IsBlank(jobPosition.clients) || IsEmpty(jobPosition.clients);
                                                                                            ISignatureAPI.GetCustomFieldOptions("Client");
                                                                                            jobPosition.clients
                                                                                        );
                                                                                        fullJobOffer: fullJobOffer;
                                                                                        signedOffers: SignedOffers;
                                                                                        info: Blank()
                                                                                    }
                                                                                )
                                                                            )
                                                                        )
                                                                    );
                                                                    AppFunctions.NotifyError(
                                                                        "Data loading error!";
                                                                        FirstError.Message;
                                                                        "An error occurred while loading form data."
                                                                    )
                                                                );;
                                                                UpdateContext({popLoadVisible: false})*/
                                                            RadiusTopLeft: =Style.RadiusFactor
                                                            Select: |-
                                                                =If(
                                                                    Self.Enable,
                                                                    Self.OnSelect()
                                                                )
                                                            Text: |-
                                                                =If(
                                                                    jobContractData.GeneralInfo.Exists,
                                                                    "See more",
                                                                    "Fill data"
                                                                )
                                                            Visible: =false
                                                            Width: =100

                                                        btnEditJobContractInfo_CandidateScreen As LabeledIconButton:
                                                            Align: =Align.Right
                                                            Enable: =jobContractData.GeneralInfo.IsEnableEdit
                                                            Icon: =Icon.Edit
                                                            LayoutMinHeight: =17
                                                            LayoutMinWidth: =640
                                                            OnSelect: |-
                                                                =With(
                                                                    {
                                                                        currentForm: forms.JobContractInfoForm,
                                                                        sheetVisible: true
                                                                    } As context,
                                                                    UpdateContext({popLoadVisible: true});
                                                                    IfError(
                                                                        With(
                                                                            AppFunctions.LoadSignedOffers(candidate.candidateState.id),
                                                                            With(
                                                                                First(SignedOffers) As fullJobOffer,
                                                                                Reset(frmJobContractInfo_CandidateScreen);
                                                                                UpdateContext(
                                                                                    Patch(
                                                                                        context,
                                                                                        {signedJobOffer: fullJobOffer}
                                                                                    )
                                                                                )
                                                                            )
                                                                        ),
                                                                        AppFunctions.NotifyError(
                                                                            "Data loading error!",
                                                                            FirstError.Message,
                                                                            "An error occurred while loading form data."
                                                                        )
                                                                    );
                                                                    UpdateContext({popLoadVisible: false})
                                                                )
                                                            RadiusTopLeft: =4
                                                            RadiusTopRigth: =4
                                                            Select: |-
                                                                =If(
                                                                    Self.Enable,
                                                                    Self.OnSelect()
                                                                )
                                                            Text: |-
                                                                =If(
                                                                    jobContractData.GeneralInfo.Exists,
                                                                    "Edit data",
                                                                    "Fill data"
                                                                )
                                                            Width: =100
                                                            ZIndex: =2

                                            shpJobContractInfoHeaderSeparator_CandidateScreen As rectangle:
                                                BorderColor: =Color.Transparent
                                                BorderStyle: =BorderStyle.None
                                                DisplayMode: =DisplayMode.View
                                                Fill: =Style.Palette.Line
                                                FocusedBorderThickness: =0
                                                Height: =1
                                                ZIndex: =2

                                            ctnJobContractInfoControls_CandidateScreen As groupContainer.verticalAutoLayoutContainer:
                                                AlignInContainer: =AlignInContainer.SetByContainer
                                                BorderColor: =Color.Transparent
                                                BorderStyle: =BorderStyle.None
                                                LayoutAlignItems: =LayoutAlignItems.Stretch
                                                LayoutDirection: =LayoutDirection.Vertical
                                                LayoutMinHeight: =100
                                                LayoutMinWidth: =250
                                                LayoutMode: =LayoutMode.Auto
                                                PaddingBottom: =15
                                                PaddingTop: =15
                                                ZIndex: =3

                                                ctnJobContractInfoFirstRow_CandidateScreen As groupContainer.verticalAutoLayoutContainer:
                                                    BorderColor: =Color.Transparent
                                                    BorderStyle: =BorderStyle.None
                                                    Fill: =Color.Transparent
                                                    LayoutAlignItems: =LayoutAlignItems.Stretch
                                                    LayoutMinHeight: =100
                                                    LayoutMinWidth: =50
                                                    LayoutMode: =LayoutMode.Auto
                                                    ZIndex: =1

                                                    ctnJobContractInfoFirstColumn_CandidateScreen As groupContainer.verticalAutoLayoutContainer:
                                                        AlignInContainer: =AlignInContainer.SetByContainer
                                                        BorderColor: =Color.Transparent
                                                        BorderStyle: =BorderStyle.None
                                                        Fill: =Color.Transparent
                                                        LayoutAlignItems: =LayoutAlignItems.Stretch
                                                        LayoutDirection: =LayoutDirection.Vertical
                                                        LayoutGap: =5
                                                        LayoutMinHeight: =100
                                                        LayoutMinWidth: =25
                                                        LayoutMode: =LayoutMode.Auto
                                                        ZIndex: =1

                                                        fldJobActivities_CandidateScreen As BasicField:
                                                            DisplayMode: =jobContractData.GeneralInfo.DisplayMode
                                                            Key: ="Job activities"
                                                            KeyWidth: =130
                                                            LayoutMinHeight: =640
                                                            LayoutMinWidth: =150
                                                            Mark: =false
                                                            Tooltip: =AppFunctions.BuildListInfo(AppFunctions.ULToTable(jobContractData.GeneralInfo.Source.extraJobActivities))
                                                            Value: |-
                                                                =If(
                                                                    IsBlank(jobContractData.GeneralInfo.Source.extraJobActivities),
                                                                    Blank(),
                                                                    "Included"
                                                                )

                                                        fldClient_CandidateScreen As BasicField:
                                                            DisplayMode: =jobContractData.GeneralInfo.DisplayMode
                                                            Key: ="Client"
                                                            KeyWidth: =130
                                                            LayoutMinHeight: =640
                                                            LayoutMinWidth: =150
                                                            Mark: =false
                                                            Value: =jobContractData.GeneralInfo.Source.client
                                                            ZIndex: =2

                                                        fldWorkLocation_CandidateScreen As BasicField:
                                                            DisplayMode: =jobContractData.GeneralInfo.DisplayMode
                                                            Key: ="Work location"
                                                            KeyWidth: =130
                                                            LayoutMinHeight: =640
                                                            LayoutMinWidth: =150
                                                            Mark: =false
                                                            Tooltip: =jobContractData.GeneralInfo.Source.workLocation
                                                            Value: =jobContractData.GeneralInfo.Source.workLocation
                                                            Wrap: =false
                                                            ZIndex: =4

                                                    ctnJobContractInfoSecondColumn_CandidateScreen As groupContainer.verticalAutoLayoutContainer:
                                                        AlignInContainer: =AlignInContainer.SetByContainer
                                                        BorderColor: =Color.Transparent
                                                        BorderStyle: =BorderStyle.None
                                                        Fill: =Color.Transparent
                                                        LayoutAlignItems: =LayoutAlignItems.Stretch
                                                        LayoutDirection: =LayoutDirection.Vertical
                                                        LayoutGap: =5
                                                        LayoutMinHeight: =100
                                                        LayoutMinWidth: =25
                                                        LayoutMode: =LayoutMode.Auto
                                                        ZIndex: =2

                                                        fldCompensationInLetter_CandidateScreen As BasicField:
                                                            DisplayMode: =jobContractData.GeneralInfo.DisplayMode
                                                            Key: ="Compensation"
                                                            KeyWidth: =130
                                                            LayoutMinHeight: =640
                                                            LayoutMinWidth: =150
                                                            Mark: =false
                                                            Value: |-
                                                                =If(
                                                                    !IsBlank(jobContractData.GeneralInfo.Source.compensation),
                                                                    "$ " & AppFunctions.FormatAmout(jobContractData.GeneralInfo.Source.compensation)
                                                                )

                                                        fldContractADFIUser_CandidateScreen As BasicField:
                                                            DisplayMode: =jobContractData.GeneralInfo.DisplayMode
                                                            Key: ="ADFI User"
                                                            KeyWidth: =130
                                                            LayoutMinHeight: =640
                                                            LayoutMinWidth: =150
                                                            Mark: =false
                                                            Tooltip: =AppFunctions.BuildUserInfo(jobContractData.GeneralInfo.Source.userADFI)
                                                            Value: =jobContractData.GeneralInfo.Source.userADFI.name
                                                            Wrap: =false
                                                            ZIndex: =2

                                                        fldContractHCUser_CandidateScreen As BasicField:
                                                            DisplayMode: =jobContractData.GeneralInfo.DisplayMode
                                                            Key: ="Total Rewards User"
                                                            KeyWidth: =130
                                                            LayoutMinHeight: =640
                                                            LayoutMinWidth: =150
                                                            Mark: =false
                                                            Tooltip: =AppFunctions.BuildUserInfo(jobContractData.GeneralInfo.Source.userHC)
                                                            Value: =jobContractData.GeneralInfo.Source.userHC.name
                                                            Wrap: =false
                                                            ZIndex: =3

                                                fldContractWorkingHours_CandidateScreen As BasicField:
                                                    DisplayMode: =jobContractData.GeneralInfo.DisplayMode
                                                    Key: ="Working hours"
                                                    KeyWidth: =130
                                                    LayoutMinHeight: =640
                                                    LayoutMinWidth: =150
                                                    Mark: =false
                                                    Tooltip: =jobContractData.GeneralInfo.Source.workingHours
                                                    Value: =jobContractData.GeneralInfo.Source.workingHours
                                                    Wrap: =false
                                                    ZIndex: =2

                                    ctnCandidatePersonalInfo_CandidateScreen As groupContainer.horizontalAutoLayoutContainer:
                                        AlignInContainer: =AlignInContainer.SetByContainer
                                        BorderColor: =Color.Transparent
                                        BorderStyle: =BorderStyle.None
                                        Fill: =Color.Transparent
                                        FillPortions: =0
                                        Height: =169
                                        LayoutAlignItems: =LayoutAlignItems.Stretch
                                        LayoutGap: =15
                                        LayoutMinHeight: =100
                                        LayoutMinWidth: =50
                                        LayoutMode: =LayoutMode.Auto
                                        ZIndex: =2

                                        fstCandidatePersonalInfoIndicator_CandidateScreen As FlowStep:
                                            Check: =jobContractData.CandidatePersonalInfo.IsCheck
                                            LayoutMinHeight: =25
                                            LayoutMinWidth: =640
                                            State: =jobContractData.CandidatePersonalInfo.IndicatorState

                                        ctnCandidatePersonalInfoSection_CandidateScreen As groupContainer.verticalAutoLayoutContainer:
                                            AlignInContainer: =AlignInContainer.SetByContainer
                                            BorderColor: =Color.Transparent
                                            BorderStyle: =BorderStyle.None
                                            Fill: =Color.Transparent
                                            LayoutAlignItems: =LayoutAlignItems.Stretch
                                            LayoutDirection: =LayoutDirection.Vertical
                                            LayoutMinHeight: =100
                                            LayoutMinWidth: =250
                                            LayoutMode: =LayoutMode.Auto
                                            ZIndex: =2

                                            ctnCandidatePersonalInfoHeader_CandidateScreen As groupContainer.horizontalAutoLayoutContainer:
                                                AlignInContainer: =AlignInContainer.SetByContainer
                                                BorderColor: =Color.Transparent
                                                BorderStyle: =BorderStyle.None
                                                Fill: =Color.Transparent
                                                FillPortions: =0
                                                Height: =32
                                                LayoutAlignItems: =LayoutAlignItems.Stretch
                                                LayoutMinHeight: =100
                                                LayoutMinWidth: =250
                                                LayoutMode: =LayoutMode.Auto
                                                ZIndex: =1

                                                lblCandidatePersonalInfo_CandidateScreen As StyledLabel:
                                                    LayoutMinHeight: =25
                                                    LayoutMinWidth: =640
                                                    Mark: =jobContractData.CandidatePersonalInfo.IsMark
                                                    Text: ="Candidate info"
                                                    Width: =175

                                                ctnCandidatePersonalInfoInfo_CandidateScreen As groupContainer.horizontalAutoLayoutContainer:
                                                    AlignInContainer: =AlignInContainer.SetByContainer
                                                    BorderColor: =Color.Transparent
                                                    BorderStyle: =BorderStyle.None
                                                    Fill: =Color.Transparent
                                                    LayoutAlignItems: =LayoutAlignItems.Stretch
                                                    LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                                                    LayoutMinHeight: =25
                                                    LayoutMinWidth: =250
                                                    LayoutMode: =LayoutMode.Auto
                                                    PaddingLeft: =10
                                                    ZIndex: =2

                                                    fldCandidatePersonalInfoStatus_CandidateScreen As BasicField:
                                                        Key: ="Status"
                                                        KeyWidth: =55
                                                        LayoutMinHeight: =25
                                                        LayoutMinWidth: =640
                                                        Mark: =jobContractData.CandidatePersonalInfo.IsMark
                                                        Value: =jobContractData.CandidatePersonalInfo.Status.Name
                                                        Width: =140

                                                    ctnCandidatePersonalInfoActions_CandidateScreen As groupContainer.horizontalAutoLayoutContainer:
                                                        AlignInContainer: =AlignInContainer.SetByContainer
                                                        BorderColor: =Color.Transparent
                                                        BorderStyle: =BorderStyle.None
                                                        Fill: =Color.Transparent
                                                        LayoutAlignItems: =LayoutAlignItems.Stretch
                                                        LayoutJustifyContent: =LayoutJustifyContent.End
                                                        LayoutMinHeight: =25
                                                        LayoutMinWidth: =250
                                                        LayoutMode: =LayoutMode.Auto
                                                        ZIndex: =2

                                                        btnSendForm_CandidateScreen As LabeledIconButton:
                                                            Align: =Align.Right
                                                            Enable: =jobContractData.CandidatePersonalInfo.IsEnableSendForm
                                                            Icon: =Icon.Send
                                                            LayoutMinHeight: =25
                                                            LayoutMinWidth: =640
                                                            OnSelect: |-
                                                                =If(
                                                                    IsBlank(candidateForms),
                                                                    candidateFormSelector_CandidateScreen.Refresh()
                                                                );
                                                                If(
                                                                    !jobContractData.Metadata.IsLoaded,
                                                                    UpdateContext({popLoadVisible: true});
                                                                    actLoadMetadata_CandidateScreen.Action();
                                                                    UpdateContext({popLoadVisible: false})
                                                                );
                                                                If(
                                                                    jobContractData.Metadata.IsLoaded,
                                                                    UpdateContext(
                                                                        {
                                                                            optionDialogModel: AppFunctions.OptionDialogFace(
                                                                                "send_candidate_form",
                                                                                "Send form to candidate",
                                                                                $"Do you want to send the ""<strong>{jobContractData.Metadata.Value.defaultForm}</strong>"" form to the candidate?",
                                                                                "Send form",
                                                                                "Cancel"
                                                                            )
                                                                        }
                                                                    )
                                                                )
                                                            RadiusTopLeft: =Style.RadiusFactor
                                                            RadiusTopRigth: =Style.RadiusFactor
                                                            Select: |-
                                                                =If(
                                                                    Self.Enable,
                                                                    Self.OnSelect()
                                                                )
                                                            Text: |-
                                                                =$"Send {If(
                                                                    !IsBlank(jobContractData.Metadata.Value.defaultForm),
                                                                    """" & jobContractData.Metadata.Value.defaultForm & """ "
                                                                )}form"
                                                            Width: =150

                                                        btnSelectForm_CandidateScreen As LabeledIconButton:
                                                            Align: =Align.Right
                                                            Enable: =jobContractData.CandidatePersonalInfo.IsEnableSelectForm
                                                            Icon: =Icon.OptionsList
                                                            LayoutMinHeight: =25
                                                            LayoutMinWidth: =640
                                                            OnSelect: |-
                                                                =Concurrent(
                                                                    If(
                                                                        IsBlank(candidateForms),
                                                                        candidateFormSelector_CandidateScreen.Refresh()
                                                                    ),
                                                                    If(
                                                                        !jobContractData.Metadata.IsLoaded,
                                                                        UpdateContext({popLoadVisible: true});
                                                                        actLoadMetadata_CandidateScreen.Action()
                                                                    );
                                                                    UpdateContext(
                                                                        {
                                                                            popLoadVisible: false,
                                                                            candidateFormSelectorVisible: true
                                                                        }
                                                                    )
                                                                )
                                                            RadiusTopLeft: =Style.RadiusFactor
                                                            RadiusTopRigth: =Style.RadiusFactor
                                                            Select: |-
                                                                =If(
                                                                    Self.Enable,
                                                                    Self.OnSelect()
                                                                )
                                                            Text: ="Select form"
                                                            Width: =102
                                                            ZIndex: =2

                                                        btnCandidatePersonalInfoDetails_CandidateScreen As LabeledIconButton:
                                                            Align: =Align.Right
                                                            Enable: =jobContractData.CandidatePersonalInfo.IsEnableDetails
                                                            Icon: |-
                                                                =If(
                                                                    jobContractData.CandidatePersonalInfo.Exists,
                                                                    Icon.View,
                                                                    Icon.Edit
                                                                )
                                                            LayoutMinHeight: =25
                                                            LayoutMinWidth: =640
                                                            OnSelect: |-
                                                                =UpdateContext({popLoadVisible: true});
                                                                If(
                                                                    IsBlank(jobContractData.CandidatePersonalInfo.Source.form.id),
                                                                    If(
                                                                        IsBlank(candidateForms),
                                                                        candidateFormSelector_CandidateScreen.Refresh()
                                                                    );
                                                                    If(
                                                                        !jobContractData.Metadata.IsLoaded,
                                                                        actLoadMetadata_CandidateScreen.Action()
                                                                    )
                                                                );
                                                                If(
                                                                    !IsBlank(jobContractData.CandidatePersonalInfo.Source.form.id) || jobContractData.Metadata.IsLoaded,
                                                                    IfError(
                                                                        With(
                                                                            jobContractData.CandidatePersonalInfo,
                                                                            With(
                                                                                LookUp(
                                                                                    candidateForms,
                                                                                    name = If(
                                                                                        IsBlank(jobContractData.CandidatePersonalInfo.Source.form),
                                                                                        jobContractData.Metadata.Value.defaultForm,
                                                                                        jobContractData.CandidatePersonalInfo.Source.form.name
                                                                                    )
                                                                                ) As form,
                                                                                With(
                                                                                    AppFunctions.LoadOtherData(
                                                                                        form.id,
                                                                                        AdditionalInfo,
                                                                                        Source.additionalInfo,
                                                                                        1
                                                                                    ),
                                                                                    Navigate(
                                                                                        FormScreen,
                                                                                        ScreenTransition.None,
                                                                                        {
                                                                                            deepScreen: DeepScreen.Candidate.JobContract.CandidatePersonalInfo,
                                                                                            isReadOnly: version.IsReadOnly,
                                                                                            isEditValues: !Exists,
                                                                                            enableFooter: !Exists,
                                                                                            formMode: AppFunctions.BooleanToFormMode(Exists),
                                                                                            version: version.Source,
                                                                                            jobPosition: jobPosition,
                                                                                            candidate: candidate.candidateState,
                                                                                            staticContent: If(
                                                                                                Exists,
                                                                                                Source,
                                                                                                Patch(
                                                                                                    Source,
                                                                                                    {
                                                                                                        name: candidate.candidateState.candidateInfo.fullName,
                                                                                                        form: form
                                                                                                    }
                                                                                                )
                                                                                            ),
                                                                                            dynamicContent: additionalInfo,
                                                                                            info: Blank()
                                                                                        }
                                                                                    );
                                                                                    If(
                                                                                        !AdditionalInfo.IsLoaded,
                                                                                        UpdateContext(
                                                                                            {
                                                                                                jobContractData: Patch(
                                                                                                    jobContractData,
                                                                                                    {
                                                                                                        CandidatePersonalInfo: Patch(
                                                                                                            jobContractData.CandidatePersonalInfo,
                                                                                                            {
                                                                                                                AdditionalInfo: {
                                                                                                                    IsLoaded: true,
                                                                                                                    Value: additionalInfo
                                                                                                                }
                                                                                                            }
                                                                                                        )
                                                                                                    }
                                                                                                )
                                                                                            }
                                                                                        )
                                                                                    )
                                                                                )
                                                                            )
                                                                        ),
                                                                        AppFunctions.NotifyError(
                                                                            "Data loading error!",
                                                                            FirstError.Message,
                                                                            "An error occurred while loading form data."
                                                                        )
                                                                    )
                                                                );
                                                                UpdateContext({popLoadVisible: false})
                                                            RadiusTopLeft: =Style.RadiusFactor
                                                            Select: |-
                                                                =If(
                                                                    Self.Enable,
                                                                    Self.OnSelect()
                                                                )
                                                            Text: |-
                                                                =If(
                                                                    jobContractData.CandidatePersonalInfo.Exists,
                                                                    "See more",
                                                                    "Fill data"
                                                                )
                                                            Width: =100
                                                            ZIndex: =3

                                            shpCandidatePersonalInfoHeaderSeparator_CandidateScreen As rectangle:
                                                BorderColor: =Color.Transparent
                                                BorderStyle: =BorderStyle.None
                                                DisplayMode: =DisplayMode.View
                                                Fill: =Style.Palette.Line
                                                FocusedBorderThickness: =0
                                                Height: =1
                                                ZIndex: =2

                                            ctnCandidatePersonalInfoControls_CandidateScreen As groupContainer.verticalAutoLayoutContainer:
                                                AlignInContainer: =AlignInContainer.SetByContainer
                                                BorderColor: =Color.Transparent
                                                BorderStyle: =BorderStyle.None
                                                LayoutAlignItems: =LayoutAlignItems.Stretch
                                                LayoutMinHeight: =100
                                                LayoutMinWidth: =250
                                                LayoutMode: =LayoutMode.Auto
                                                PaddingBottom: =15
                                                PaddingTop: =15
                                                ZIndex: =3

                                                ctnCandidatePersonalFirstColumn_CandidateScreen As groupContainer.verticalAutoLayoutContainer:
                                                    AlignInContainer: =AlignInContainer.SetByContainer
                                                    BorderColor: =Color.Transparent
                                                    BorderStyle: =BorderStyle.None
                                                    Fill: =Color.Transparent
                                                    LayoutAlignItems: =LayoutAlignItems.Stretch
                                                    LayoutDirection: =LayoutDirection.Vertical
                                                    LayoutGap: =5
                                                    LayoutMinHeight: =100
                                                    LayoutMinWidth: =25
                                                    LayoutMode: =LayoutMode.Auto
                                                    ZIndex: =1

                                                    fldIdentification_CandidateScreen As BasicField:
                                                        DisplayMode: =jobContractData.CandidatePersonalInfo.DisplayMode
                                                        Key: ="Identification"
                                                        KeyWidth: =130
                                                        LayoutMinHeight: =640
                                                        LayoutMinWidth: =150
                                                        Mark: =false
                                                        Value: =jobContractData.CandidatePersonalInfo.Source.idNumber

                                                    fldBirthDate_CandidateScreen As BasicField:
                                                        DisplayMode: =jobContractData.CandidatePersonalInfo.DisplayMode
                                                        Key: ="Birth date"
                                                        KeyWidth: =130
                                                        LayoutMinHeight: =640
                                                        LayoutMinWidth: =150
                                                        Mark: =false
                                                        Tooltip: =AppFunctions.FormatLongDateValue(jobContractData.CandidatePersonalInfo.Source.birthDate)
                                                        Value: =AppFunctions.FormatDateValue(jobContractData.CandidatePersonalInfo.Source.birthDate)
                                                        ZIndex: =2

                                                    fldPhone_CandidateScreen As BasicField:
                                                        DisplayMode: =jobContractData.CandidatePersonalInfo.DisplayMode
                                                        Key: ="Phone number"
                                                        KeyWidth: =130
                                                        LayoutMinHeight: =640
                                                        LayoutMinWidth: =150
                                                        Mark: =false
                                                        Value: =jobContractData.CandidatePersonalInfo.Source.phoneNumber
                                                        ZIndex: =3

                                                ctnCandidatePersonalInfoSecondColumn_CandidateScreen As groupContainer.verticalAutoLayoutContainer:
                                                    AlignInContainer: =AlignInContainer.SetByContainer
                                                    BorderColor: =Color.Transparent
                                                    BorderStyle: =BorderStyle.None
                                                    Fill: =Color.Transparent
                                                    LayoutAlignItems: =LayoutAlignItems.Stretch
                                                    LayoutDirection: =LayoutDirection.Vertical
                                                    LayoutGap: =5
                                                    LayoutMinHeight: =100
                                                    LayoutMinWidth: =250
                                                    LayoutMode: =LayoutMode.Auto
                                                    ZIndex: =2

                                                    fldNationality_CandidateScreen As BasicField:
                                                        DisplayMode: =jobContractData.CandidatePersonalInfo.DisplayMode
                                                        Key: ="Nationality"
                                                        KeyWidth: =130
                                                        LayoutMinHeight: =640
                                                        LayoutMinWidth: =50
                                                        Mark: =false
                                                        Value: =jobContractData.CandidatePersonalInfo.Source.nationality

                                                    fldEducationalLevel_CandidateScreen As BasicField:
                                                        DisplayMode: =jobContractData.CandidatePersonalInfo.DisplayMode
                                                        Key: ="Educational level"
                                                        KeyWidth: =130
                                                        LayoutMinHeight: =640
                                                        LayoutMinWidth: =50
                                                        Mark: =false
                                                        Value: =AppFunctions.CodeToEducationalDegree(jobContractData.CandidatePersonalInfo.Source.educationalLevel).Name
                                                        ZIndex: =2

                                                    fldForm_CandidateScreen As BasicField:
                                                        DisplayMode: =jobContractData.CandidatePersonalInfo.DisplayMode
                                                        Key: ="Form"
                                                        KeyWidth: =130
                                                        LayoutMinHeight: =640
                                                        LayoutMinWidth: =50
                                                        Mark: =false
                                                        Value: =jobContractData.CandidatePersonalInfo.Source.form.name
                                                        ZIndex: =3

                                                    fldFieldOfStudy_CandidateScreen As BasicField:
                                                        DisplayMode: =jobContractData.CandidatePersonalInfo.DisplayMode
                                                        Key: ="Field of study"
                                                        KeyWidth: =130
                                                        LayoutMinHeight: =640
                                                        LayoutMinWidth: =50
                                                        Mark: =false
                                                        Value: =jobContractData.CandidatePersonalInfo.Source.fieldStudy
                                                        Visible: =false
                                                        ZIndex: =4

                                    ctnTerms_CandidateScreen As groupContainer.horizontalAutoLayoutContainer:
                                        AlignInContainer: =AlignInContainer.SetByContainer
                                        BorderColor: =Color.Transparent
                                        BorderStyle: =BorderStyle.None
                                        Fill: =Color.Transparent
                                        FillPortions: =0
                                        Height: =169
                                        LayoutAlignItems: =LayoutAlignItems.Stretch
                                        LayoutGap: =15
                                        LayoutMinHeight: =100
                                        LayoutMinWidth: =50
                                        LayoutMode: =LayoutMode.Auto
                                        ZIndex: =3

                                        fstTermsIndicator_CandidateScreen As FlowStep:
                                            Check: =jobContractData.Terms.IsCheck
                                            LayoutMinHeight: =25
                                            LayoutMinWidth: =640
                                            State: =jobContractData.Terms.IndicatorState

                                        ctnTermsSection_CandidateScreen As groupContainer.verticalAutoLayoutContainer:
                                            AlignInContainer: =AlignInContainer.SetByContainer
                                            BorderColor: =Color.Transparent
                                            BorderStyle: =BorderStyle.None
                                            Fill: =Color.Transparent
                                            LayoutAlignItems: =LayoutAlignItems.Stretch
                                            LayoutDirection: =LayoutDirection.Vertical
                                            LayoutMinHeight: =100
                                            LayoutMinWidth: =250
                                            LayoutMode: =LayoutMode.Auto
                                            ZIndex: =2

                                            ctnTermsHeader_CandidateScreen As groupContainer.horizontalAutoLayoutContainer:
                                                AlignInContainer: =AlignInContainer.SetByContainer
                                                BorderColor: =Color.Transparent
                                                BorderStyle: =BorderStyle.None
                                                Fill: =Color.Transparent
                                                FillPortions: =0
                                                Height: =32
                                                LayoutAlignItems: =LayoutAlignItems.Stretch
                                                LayoutMinHeight: =100
                                                LayoutMinWidth: =250
                                                LayoutMode: =LayoutMode.Auto
                                                ZIndex: =1

                                                lblTerms_CandidateScreen As StyledLabel:
                                                    LayoutMinHeight: =25
                                                    LayoutMinWidth: =640
                                                    Mark: =jobContractData.Terms.IsMark
                                                    Text: ="Terms"
                                                    Width: =175

                                                ctnTermsDetailsInfo_CandidateScreen As groupContainer.horizontalAutoLayoutContainer:
                                                    AlignInContainer: =AlignInContainer.SetByContainer
                                                    BorderColor: =Color.Transparent
                                                    BorderStyle: =BorderStyle.None
                                                    Fill: =Color.Transparent
                                                    LayoutAlignItems: =LayoutAlignItems.Stretch
                                                    LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                                                    LayoutMinHeight: =25
                                                    LayoutMinWidth: =250
                                                    LayoutMode: =LayoutMode.Auto
                                                    PaddingLeft: =10
                                                    ZIndex: =2

                                                    fldTermsStatus_CandidateScreen As BasicField:
                                                        Key: ="Status"
                                                        KeyWidth: =55
                                                        LayoutMinHeight: =25
                                                        LayoutMinWidth: =640
                                                        Mark: =jobContractData.Terms.IsMark
                                                        Value: =jobContractData.Terms.Status.Name
                                                        Width: =140

                                                    ctnTermsActions_CandidateScreen As groupContainer.horizontalAutoLayoutContainer:
                                                        AlignInContainer: =AlignInContainer.SetByContainer
                                                        BorderColor: =Color.Transparent
                                                        BorderStyle: =BorderStyle.None
                                                        Fill: =Color.Transparent
                                                        LayoutAlignItems: =LayoutAlignItems.Stretch
                                                        LayoutJustifyContent: =LayoutJustifyContent.End
                                                        LayoutMinHeight: =25
                                                        LayoutMinWidth: =250
                                                        LayoutMode: =LayoutMode.Auto
                                                        ZIndex: =2

                                                        btnTermsDetails_CandidateScreen As LabeledIconButton:
                                                            Align: =Align.Right
                                                            Enable: =jobContractData.Terms.IsEnableDetails
                                                            Icon: |-
                                                                =If(
                                                                    jobContractData.Terms.Exists,
                                                                    Icon.View,
                                                                    Icon.Edit
                                                                )
                                                            LayoutMinHeight: =25
                                                            LayoutMinWidth: =640
                                                            OnSelect: |-
                                                                =UpdateContext({popLoadVisible: true});
                                                                IfError(
                                                                    With(
                                                                        jobContractData.Terms,
                                                                        With(
                                                                            AppFunctions.LoadOtherData(
                                                                                version.Source.template.id,
                                                                                AdditionalData,
                                                                                Source.additionalData,
                                                                                2
                                                                            ),
                                                                            Navigate(
                                                                                FormScreen,
                                                                                ScreenTransition.None,
                                                                                {
                                                                                    deepScreen: DeepScreen.Candidate.JobContract.Terms,
                                                                                    isReadOnly: version.IsReadOnly,
                                                                                    isEditValues: !Exists,
                                                                                    enableFooter: !Exists,
                                                                                    formMode: AppFunctions.BooleanToFormMode(Exists),
                                                                                    version: version.Source,
                                                                                    jobPosition: jobPosition,
                                                                                    candidate: candidate.candidateState,
                                                                                    staticContent: If(
                                                                                        Exists,
                                                                                        Source,
                                                                                        Patch(
                                                                                            Source,
                                                                                            {
                                                                                                period: 1,
                                                                                                expeditionDate: AppFunctions.ToISODate(Now()),
                                                                                                startDate: AppFunctions.ToISODate(Now()),
                                                                                                endDate: AppFunctions.ToISODate(
                                                                                                    DateAdd(
                                                                                                        Now(),
                                                                                                        3,
                                                                                                        TimeUnit.Months
                                                                                                    )
                                                                                                )
                                                                                            }
                                                                                        )
                                                                                    ),
                                                                                    dynamicContent: additionalInfo,
                                                                                    info: Table(
                                                                                        {
                                                                                            Key: "Client",
                                                                                            Value: jobContractData.GeneralInfo.Source.client,
                                                                                            Tooltip: "",
                                                                                            Mark: true,
                                                                                            ShowSeparator: false
                                                                                        }
                                                                                    )
                                                                                }
                                                                            );
                                                                            If(
                                                                                !AdditionalData.IsLoaded,
                                                                                UpdateContext(
                                                                                    {
                                                                                        jobContractData: Patch(
                                                                                            jobContractData,
                                                                                            {
                                                                                                Terms: Patch(
                                                                                                    jobContractData.Terms,
                                                                                                    {
                                                                                                        AdditionalData: {
                                                                                                            IsLoaded: true,
                                                                                                            Value: additionalInfo
                                                                                                        }
                                                                                                    }
                                                                                                )
                                                                                            }
                                                                                        )
                                                                                    }
                                                                                )
                                                                            )
                                                                        )
                                                                    ),
                                                                    AppFunctions.NotifyError(
                                                                        "Data loading error!",
                                                                        FirstError.Message,
                                                                        "An error occurred while loading form data."
                                                                    )
                                                                );
                                                                UpdateContext({popLoadVisible: false})
                                                            RadiusTopLeft: =Style.RadiusFactor
                                                            Select: |-
                                                                =If(
                                                                    Self.Enable,
                                                                    Self.OnSelect()
                                                                )
                                                            Text: |-
                                                                =If(
                                                                    jobContractData.Terms.Exists,
                                                                    "See more",
                                                                    "Fill data"
                                                                )
                                                            Width: =100

                                            shpTermsHeaderSeparator_CandidateScreen As rectangle:
                                                BorderColor: =Color.Transparent
                                                BorderStyle: =BorderStyle.None
                                                DisplayMode: =DisplayMode.View
                                                Fill: =Style.Palette.Line
                                                FocusedBorderThickness: =0
                                                Height: =1
                                                ZIndex: =2

                                            ctnTermsControls_CandidateScreen As groupContainer.verticalAutoLayoutContainer:
                                                AlignInContainer: =AlignInContainer.SetByContainer
                                                BorderColor: =Color.Transparent
                                                BorderStyle: =BorderStyle.None
                                                LayoutAlignItems: =LayoutAlignItems.Stretch
                                                LayoutMinHeight: =100
                                                LayoutMinWidth: =250
                                                LayoutMode: =LayoutMode.Auto
                                                PaddingBottom: =15
                                                PaddingTop: =15
                                                ZIndex: =3

                                                ctnTermsFirstColumn_CandidateScreen As groupContainer.verticalAutoLayoutContainer:
                                                    AlignInContainer: =AlignInContainer.SetByContainer
                                                    BorderColor: =Color.Transparent
                                                    BorderStyle: =BorderStyle.None
                                                    Fill: =Color.Transparent
                                                    LayoutAlignItems: =LayoutAlignItems.Stretch
                                                    LayoutDirection: =LayoutDirection.Vertical
                                                    LayoutGap: =5
                                                    LayoutMinHeight: =100
                                                    LayoutMinWidth: =25
                                                    LayoutMode: =LayoutMode.Auto
                                                    ZIndex: =1

                                                    fldContractPeriod_CandidateScreen As BasicField:
                                                        DisplayMode: =jobContractData.Terms.DisplayMode
                                                        Key: ="Contract period"
                                                        KeyWidth: =130
                                                        LayoutMinHeight: =640
                                                        LayoutMinWidth: =150
                                                        Mark: =false
                                                        Value: =AppFunctions.CodeToPeriod(jobContractData.Terms.Source.period).Name

                                                    fldExpeditionDate_CandidateScreen As BasicField:
                                                        DisplayMode: =jobContractData.Terms.DisplayMode
                                                        Key: ="Expedition date"
                                                        KeyWidth: =130
                                                        LayoutMinHeight: =640
                                                        LayoutMinWidth: =150
                                                        Mark: =false
                                                        Tooltip: =AppFunctions.FormatLongDateValue(jobContractData.Terms.Source.expeditionDate)
                                                        Value: =AppFunctions.FormatDateValue(jobContractData.Terms.Source.expeditionDate)
                                                        ZIndex: =4

                                                ctnTermsSecondColumn_CandidateScreen As groupContainer.verticalAutoLayoutContainer:
                                                    AlignInContainer: =AlignInContainer.SetByContainer
                                                    BorderColor: =Color.Transparent
                                                    BorderStyle: =BorderStyle.None
                                                    Fill: =Color.Transparent
                                                    LayoutAlignItems: =LayoutAlignItems.Stretch
                                                    LayoutDirection: =LayoutDirection.Vertical
                                                    LayoutGap: =5
                                                    LayoutMinHeight: =100
                                                    LayoutMinWidth: =25
                                                    LayoutMode: =LayoutMode.Auto
                                                    ZIndex: =2

                                                    fldContractStartDate_CandidateScreen As BasicField:
                                                        DisplayMode: =jobContractData.Terms.DisplayMode
                                                        Key: ="Start date"
                                                        KeyWidth: =130
                                                        LayoutMinHeight: =640
                                                        LayoutMinWidth: =150
                                                        Mark: =false
                                                        Tooltip: =AppFunctions.FormatLongDateValue(jobContractData.Terms.Source.startDate)
                                                        Value: =AppFunctions.FormatDateValue(jobContractData.Terms.Source.startDate)

                                                    fldContractEndDate_CandidateScreen As BasicField:
                                                        DisplayMode: =jobContractData.Terms.DisplayMode
                                                        Key: ="End date"
                                                        KeyWidth: =130
                                                        LayoutMinHeight: =640
                                                        LayoutMinWidth: =150
                                                        Mark: =false
                                                        Tooltip: =AppFunctions.FormatLongDateValue(jobContractData.Terms.Source.endDate)
                                                        Value: =AppFunctions.FormatDateValue(jobContractData.Terms.Source.endDate)
                                                        ZIndex: =2

                                    ctnContractSignature_CandidateScreen As groupContainer.horizontalAutoLayoutContainer:
                                        AlignInContainer: =AlignInContainer.SetByContainer
                                        BorderColor: =Color.Transparent
                                        BorderStyle: =BorderStyle.None
                                        Fill: =Color.Transparent
                                        FillPortions: =0
                                        Height: =169
                                        LayoutAlignItems: =LayoutAlignItems.Stretch
                                        LayoutGap: =15
                                        LayoutMinHeight: =100
                                        LayoutMinWidth: =50
                                        LayoutMode: =LayoutMode.Auto
                                        ZIndex: =4

                                        fstContractSignature_CandidateScreen As FlowStep:
                                            BottomBarVisible: =false
                                            Check: =jobContractData.ContractSignature.IsCheck
                                            LayoutMinHeight: =25
                                            LayoutMinWidth: =640
                                            State: =jobContractData.ContractSignature.IndicatorState

                                        ctnContractSignatureSection_CandidateScreen As groupContainer.verticalAutoLayoutContainer:
                                            AlignInContainer: =AlignInContainer.SetByContainer
                                            BorderColor: =Color.Transparent
                                            BorderStyle: =BorderStyle.None
                                            Fill: =Color.Transparent
                                            LayoutAlignItems: =LayoutAlignItems.Stretch
                                            LayoutDirection: =LayoutDirection.Vertical
                                            LayoutMinHeight: =100
                                            LayoutMinWidth: =250
                                            LayoutMode: =LayoutMode.Auto
                                            ZIndex: =2

                                            ctnContractSignatureHeader_CandidateScreen As groupContainer.horizontalAutoLayoutContainer:
                                                AlignInContainer: =AlignInContainer.SetByContainer
                                                BorderColor: =Color.Transparent
                                                BorderStyle: =BorderStyle.None
                                                Fill: =Color.Transparent
                                                FillPortions: =0
                                                Height: =32
                                                LayoutAlignItems: =LayoutAlignItems.Stretch
                                                LayoutMinHeight: =100
                                                LayoutMinWidth: =250
                                                LayoutMode: =LayoutMode.Auto
                                                ZIndex: =1

                                                lblContractSignature_CandidateScreen As StyledLabel:
                                                    LayoutMinHeight: =25
                                                    LayoutMinWidth: =640
                                                    Mark: =jobContractData.ContractSignature.IsMark
                                                    Text: ="Signing of contract"
                                                    Width: =175

                                                ctnContractSignatureInfo_CandidateScreen As groupContainer.horizontalAutoLayoutContainer:
                                                    AlignInContainer: =AlignInContainer.SetByContainer
                                                    BorderColor: =Color.Transparent
                                                    BorderStyle: =BorderStyle.None
                                                    Fill: =Color.Transparent
                                                    LayoutAlignItems: =LayoutAlignItems.Stretch
                                                    LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                                                    LayoutMinHeight: =25
                                                    LayoutMinWidth: =250
                                                    LayoutMode: =LayoutMode.Auto
                                                    PaddingLeft: =10
                                                    ZIndex: =2

                                                    fldContractSignatureStatus_CandidateScreen As BasicField:
                                                        Key: ="Status"
                                                        KeyWidth: =55
                                                        LayoutMinHeight: =25
                                                        LayoutMinWidth: =640
                                                        Mark: =jobContractData.ContractSignature.IsMark
                                                        Value: =jobContractData.ContractSignature.Status.Name
                                                        Width: =140

                                                    ctnContractSignatureActions_CandidateScreen As groupContainer.horizontalAutoLayoutContainer:
                                                        AlignInContainer: =AlignInContainer.SetByContainer
                                                        BorderColor: =Color.Transparent
                                                        BorderStyle: =BorderStyle.None
                                                        Fill: =Color.Transparent
                                                        LayoutAlignItems: =LayoutAlignItems.Stretch
                                                        LayoutJustifyContent: =LayoutJustifyContent.End
                                                        LayoutMinHeight: =25
                                                        LayoutMinWidth: =250
                                                        LayoutMode: =LayoutMode.Auto
                                                        ZIndex: =2

                                                        btnSendContractForSignature_CandidateScreen As LabeledIconButton:
                                                            Align: =Align.Right
                                                            Enable: =jobContractData.ContractSignature.IsEnableSend
                                                            Icon: =Icon.Send
                                                            LayoutMinHeight: =25
                                                            LayoutMinWidth: =640
                                                            OnSelect: |-
                                                                =UpdateContext(
                                                                    {
                                                                        optionDialogModel: AppFunctions.OptionDialogFace(
                                                                            "send_job_contract",
                                                                            "Send for signature",
                                                                            $"Send job contract to <strong>{candidate.candidateState.candidateInfo.fullName}</strong>?",
                                                                            "Send",
                                                                            "Cancel"
                                                                        )
                                                                    }
                                                                )
                                                            RadiusTopLeft: =Style.RadiusFactor
                                                            Select: |-
                                                                =If(
                                                                    Self.Enable,
                                                                    Self.OnSelect()
                                                                )
                                                            Text: ="Send for signature"
                                                            Width: =175

                                            shpContractSignatureHeaderSeparator_CandidateScreen As rectangle:
                                                BorderColor: =Color.Transparent
                                                BorderStyle: =BorderStyle.None
                                                DisplayMode: =DisplayMode.View
                                                Fill: =Style.Palette.Line
                                                FocusedBorderThickness: =0
                                                Height: =1
                                                ZIndex: =2

                                            ctnContractSignatureControls_CandidateScreen As groupContainer.verticalAutoLayoutContainer:
                                                AlignInContainer: =AlignInContainer.SetByContainer
                                                BorderColor: =Color.Transparent
                                                BorderStyle: =BorderStyle.None
                                                LayoutAlignItems: =LayoutAlignItems.Stretch
                                                LayoutDirection: =LayoutDirection.Vertical
                                                LayoutMinHeight: =100
                                                LayoutMinWidth: =250
                                                LayoutMode: =LayoutMode.Auto
                                                PaddingBottom: =15
                                                PaddingTop: =15
                                                ZIndex: =3

                                                ctnContractSignatureTopRow_CandidateScreen As groupContainer.verticalAutoLayoutContainer:
                                                    AlignInContainer: =AlignInContainer.SetByContainer
                                                    BorderColor: =Color.Transparent
                                                    BorderStyle: =BorderStyle.None
                                                    Fill: =Color.Transparent
                                                    FillPortions: =0
                                                    Height: =32
                                                    LayoutAlignItems: =LayoutAlignItems.Stretch
                                                    LayoutGap: =5
                                                    LayoutMinHeight: =100
                                                    LayoutMinWidth: =25
                                                    LayoutMode: =LayoutMode.Auto
                                                    ZIndex: =1

                                                    fldSentContractAt_CandidateScreen As BasicField:
                                                        DisplayMode: =jobContractData.ContractSignature.DisplayMode
                                                        FillPortions: =1
                                                        Key: ="Send at"
                                                        LayoutMinHeight: =25
                                                        LayoutMinWidth: =25
                                                        Mark: =false
                                                        Tooltip: =AppFunctions.FormatLongDateTimeValue(jobContractData.ContractSignature.Source.createdOn)
                                                        Value: =AppFunctions.FormatDateTimeValue(jobContractData.ContractSignature.Source.createdOn)

                                                    fldUpdatedContractAt_CandidateScreen As BasicField:
                                                        DisplayMode: =jobContractData.ContractSignature.DisplayMode
                                                        FillPortions: =1
                                                        Key: ="Updated at"
                                                        KeyWidth: =130
                                                        LayoutMinHeight: =25
                                                        LayoutMinWidth: =25
                                                        Mark: =false
                                                        Tooltip: =AppFunctions.FormatLongDateTimeValue(jobContractData.ContractSignature.Source.modifiedOn)
                                                        Value: =AppFunctions.FormatDateTimeValue(jobContractData.ContractSignature.Source.modifiedOn)
                                                        ZIndex: =2

                                                ctnContractSignatureBottomRow_CandidateScreen As groupContainer.verticalAutoLayoutContainer:
                                                    AlignInContainer: =AlignInContainer.SetByContainer
                                                    BorderColor: =Color.Transparent
                                                    BorderStyle: =BorderStyle.None
                                                    Fill: =Color.Transparent
                                                    FillPortions: =0
                                                    Height: =32
                                                    LayoutAlignItems: =LayoutAlignItems.Stretch
                                                    LayoutDirection: =LayoutDirection.Vertical
                                                    LayoutGap: =5
                                                    LayoutMinHeight: =100
                                                    LayoutMinWidth: =25
                                                    LayoutMode: =LayoutMode.Auto
                                                    ZIndex: =2

                                                    flContractMessage_CandidateScreen As BasicField:
                                                        DisplayMode: =jobContractData.ContractSignature.DisplayMode
                                                        Key: ="Message"
                                                        KeyWidth: =130
                                                        LayoutMinHeight: =640
                                                        LayoutMinWidth: =640
                                                        Mark: =false
                                                        Tooltip: =Self.Value
                                                        Value: |-
                                                            =If(
                                                                IsBlank(jobContractData.ContractSignature.Source.message),
                                                                "Waiting for status update",
                                                                jobOfferData.OfferSignature.Source.message
                                                            )
                                                        Visible: =true

                            popLoadVersion_CandidateScreen As PopupImager:
                                Height: =Parent.Height
                                Img: =GrayEllipsis
                                Visible: =isLoadingVersion
                                Width: =Parent.Width
                                ZIndex: =2

                            panNoVersion_CandidateScreen As MessagePanel:
                                Img: =Document
                                Message: |-
                                    =If(
                                        IsBlank(versions) || IsEmpty(versions),
                                        $"No {processStep.LowerName} versions available",
                                        "Failed to load current version"
                                    )
                                Visible: |-
                                    =!isLoadingVersion && Switch(
                                        processStep.Code,
                                        DeepScreen.Candidate.JobOffer.Code,
                                        IsBlank(jobOfferData),
                                        DeepScreen.Candidate.JobContract.Code,
                                        IsBlank(jobContractData)
                                    )
                                Width: =Parent.Width
                                Y: =Parent.Height / 2 - Self.Height / 2
                                ZIndex: =3

    templateSelector_CandidateScreen As TemplateSelector:
        IsLoadingItems: =isLoadingTemplates
        IsSaving: =isSavingVersion
        Items: =templates.Items
        OnRefresh: |-
            =UpdateContext({isLoadingTemplates: true});
            UpdateContext(
                {
                    templates: {
                        Type: processStep,
                        Items: With(
                            {
                                loadedItems: IfError(
                                    Switch(
                                        processStep.Code,
                                        DeepScreen.Candidate.JobOffer.Code,//Propuesta laboral
                                        ISignatureAPI.GetTemplates("Propuesta"),
                                        DeepScreen.Candidate.JobContract.Code,//Contrato laboral
                                        ISignatureAPI.GetTemplates("Contrato")
                                    ),
                                    AppFunctions.NotifyError(
                                        "Error loading templates!",
                                        FirstError.Message,
                                        $"I was not possible to load the {processStep.LowerName} templates."
                                    );
                                    Blank()
                                )
                            },
                            ForAll(
                                loadedItems,
                                Patch(
                                    ThisRecord,
                                    {
                                        capitalLetter: Left(
                                            name,
                                            1
                                        ),
                                        color: AppFunctions.RandomColor()
                                    }
                                )
                            )
                        )
                    }
                }
            );
            UpdateContext({isLoadingTemplates: false})
        OnSelectAccept: |-
            =UpdateContext({isSavingVersion: true});
            IfError(
                With(
                    {
                        versionName: "Version " & If(
                            IsBlank(versions),
                            1,
                            CountRows(versions) + 1
                        )
                    },
                    With(
                        With(
                            {
                                idCandidateState: candidate.candidateState.id,
                                status: VersionState.New.Code,
                                version: versionName,
                                template: Self.Selected
                            } As requestBody,
                            Switch(
                                processStep.Code,
                                DeepScreen.Candidate.JobOffer.Code,
                                ISignatureAPI.CreateJobOfferVersion(requestBody),
                                DeepScreen.Candidate.JobContract.Code,
                                ISignatureAPI.CreateJobContractVersion(requestBody)
                            )
                        ),
                        Concurrent(
                            AppFunctions.NotifySuccess(
                                $"New {processStep.LowerName} version created!",
                                $"<strong>{versionName}</strong> has been created."
                            ),
                            UpdateContext(
                                {
                                    version: Blank(),
                                    jobOfferData: Blank(),
                                    jobContractData: Blank(),
                                    isCreatingVersion: true
                                }
                            );
                            versioningPanel_CandidateScreen.Refresh()
                        )
                    )
                ),
                AppFunctions.NotifyError(
                    $"Error saving {processStep.LowerName} version!",
                    FirstError.Message
                )
            );
            UpdateContext(
                {
                    templateSelectorVisible: false,
                    isSavingVersion: false
                }
            );
            Reset(Self)
        OnSelectCancel: |-
            =UpdateContext({templateSelectorVisible: false});
            Reset(Self)
        Refresh: =Self.OnRefresh()
        SelectAccept: =Self.OnSelectAccept()
        SelectCancel: =Self.OnSelectCancel()
        Title: =$"{processStep.Name} template selection"
        Visible: =templateSelectorVisible
        ZIndex: =3

    candidateFormSelector_CandidateScreen As CandidateFormSelector:
        Default: |-
            =LookUp(
                candidateForms,
                name = jobContractData.Metadata.Value.defaultForm
            )
        IsLoadingItems: =isLoadingCandidateForms
        IsSaving: =isSendForm
        Items: |-
            =ForAll(
                jobContractData.Metadata.Value.additionalForms,
                LookUp(
                    candidateForms,
                    name = Value
                )
            )
        OnRefresh: |-
            =UpdateContext({isLoadingCandidateForms: true});
            UpdateContext(
                {
                    candidateForms: IfError(
                        ISignatureAPI.GetForms(),
                        AppFunctions.NotifyError(
                            "Error loading forms!",
                            FirstError.Message,
                            $"I was not possible to load the forms."
                        );
                        Blank()
                    )
                }
            );
            UpdateContext({isLoadingCandidateForms: false})
        OnSelectAccept: |-
            =UpdateContext({isSendForm: true});
            IfError(
                With(
                    ISignatureAPI.CreateCandidateInfo(
                        {
                            status: VersionSectionState.Waiting.Code,
                            idJobContract: version.Source.id,
                            form: Self.Selected
                        }
                    ),
                    AppFunctions.NotifySuccess(
                        "Form sent to candidate!",
                        $"The request for filling out the form has been sent to the candidate <strong>{candidate.candidateState.candidateInfo.fullName}</strong>."
                    );
                    versioningPanel_CandidateScreen.Select()
                ),
                AppFunctions.NotifyError(
                    "Error sending form!",
                    FirstError.Message
                )
            );
            UpdateContext(
                {
                    isSendForm: false,
                    candidateFormSelectorVisible: false
                }
            );
            Reset(Self)
        OnSelectCancel: |-
            =UpdateContext({candidateFormSelectorVisible: false});
            Reset(Self)
        Refresh: =Self.OnRefresh()
        Visible: =candidateFormSelectorVisible
        ZIndex: =4

    sheet_CandidateScreen As Sheet:
        AcceptText: =currentForm.AcceptText
        CancelText: =currentForm.CancelText
        EnableCancelButton: =!isSavingForm
        EnableSaveButton: |-
            =!isSavingForm && Switch(
                currentForm.Code,
                forms.GeneralInfoForm.Code,
                frmGeneralInfo_CandidateScreen.Validation,
                forms.JobContractInfoForm.Code,
                frmJobContractInfo_CandidateScreen.IsValid
            )
        OnSelectAccept: |
            =UpdateContext({isSavingForm: true});
            Switch(
                currentForm.Code,
                forms.GeneralInfoForm.Code,
                IfError(
                    With(
                        If(
                            jobOfferData.GeneralInfo.Exists,
                            ISignatureAPI.UpdateGeneralData(
                                Patch(
                                    frmGeneralInfo_CandidateScreen.GetValue(),
                                    {id: jobOfferData.GeneralInfo.Source.id}
                                )
                            ),
                            ISignatureAPI.CreateGeneralData(frmGeneralInfo_CandidateScreen.GetValue())
                        ) As response,
                        AppFunctions.NotifySuccess(
                            "General information saved successfully!",
                            $"The general information of the job offer <strong>{version.Source.version}</strong> have been saved."
                        );
                        versioningPanel_CandidateScreen.Select()
                    ),
                    AppFunctions.NotifyError(
                        "Error saving general infromation!",
                        FirstError.Message,
                        $"An error ocurred while trying to save general job offer information."
                    )
                );
                Reset(frmGeneralInfo_CandidateScreen),
                forms.JobContractInfoForm.Code,
                IfError(
                    With(
                        With(
                            Patch(
                                frmJobContractInfo_CandidateScreen.GetValue(),
                                {
                                    idJobContract: version.Source.id,
                                    status: VersionSectionState.Completed.Code
                                }
                            ) As requestBody,
                            If(
                                jobContractData.GeneralInfo.Exists,
                                ISignatureAPI.UpdateJobContractInfo(
                                    Patch(
                                        requestBody,
                                        {id: jobContractData.GeneralInfo.Source.id}
                                    )
                                ),
                                ISignatureAPI.CreateJobContractInfo(requestBody)
                            )
                        ) As response,
                        AppFunctions.NotifySuccess(
                            "General information saved successfully!",
                            $"The general information of the job offer <strong>{version.Source.version}</strong> have been saved."
                        );
                        versioningPanel_CandidateScreen.Select()
                    ),
                    AppFunctions.NotifyError(
                        "Error saving general infromation!",
                        FirstError.Message,
                        $"An error ocurred while trying to save general job contract information."
                    )
                );
                UpdateContext({signedJobOffer: Blank()})
            );
            UpdateContext(
                {
                    sheetVisible: false,
                    isSavingForm: false
                }
            );
        OnSelectCancel: |-
            =/*UpdateContext(
                {
                    optionDialogModel: AppFunctions.OptionDialogFace(
                        "exit_form";
                        "Exit the form";
                        "Do you want to leave the form? No data will be saved";
                        "Close the form";
                        "Back to form"
                    )
                }
            )*/
            UpdateContext({sheetVisible: false});
            Switch(
                currentForm.Code,
                forms.GeneralInfoForm.Code,
                Reset(frmGeneralInfo_CandidateScreen),
                forms.JobContractInfoForm.Code,
                Reset(frmJobContractInfo_CandidateScreen)
            )
        SelectAccept: =Self.OnSelectAccept()
        SelectCancel: =Self.OnSelectCancel()
        SheetWidth: =currentForm.SheetWidth
        Title: =currentForm.Name
        Visible: =sheetVisible
        ZIndex: =5

    frmGeneralInfo_CandidateScreen As GeneralInfoForm:
        ADFIUsers: =ISignatureAPI.GetUsers("Admin")
        Default: |-
            =If(
                jobOfferData.GeneralInfo.Exists,
                jobOfferData.GeneralInfo.Source,
                Self.SuggestedDefault(version.Source.id)
            )
        FormMode: |-
            =If(
                jobOfferData.GeneralInfo.Exists,
                FormMode.Edit,
                FormMode.New
            )
        GetValue: |-
            ={
                name: Self.Default.name,
                workingHours: Self.WorkingHours.Value,
                status: Self.VersionSectionState.Completed.Code,
                startDate: Self.StartDate.Value,
                deadlineDate: Self.DeadlineDate.Value,
                idJobOffer: Self.Default.idJobOffer,
                userADFI: With(
                    comADFIUser_GeneralInfoForm.Selected,
                    {
                        id: id,
                        name: name,
                        email: email,
                        idSystemUser: idSystemUser,
                        role: role
                    }
                ),
                userHC: comTotalRewardsUser_GeneralInfoForm.Selected
            }
        Height: =sheet_CandidateScreen.BodyHeight
        HumanCapitalUsers: =ISignatureAPI.GetUsers("Admin")
        IsSaving: =isSavingForm
        SuggestedDefault: |-
            ={
                name: "",
                workingHours: "Monday to Friday: 08:00 to 17:30, Saturday: 08:00 to 13:30",
                status: -1,
                startDate: Text(
                    DateAdd(
                        Today(),
                        5,
                        TimeUnit.Days
                    ),
                    DateTimeFormat.UTC
                ),
                deadlineDate: Text(
                    Today(),
                    DateTimeFormat.UTC
                ),
                idJobOffer: IdJobOffer,
                userADFI: Blank(),
                userHC: Blank()
            }
        Visible: =sheetVisible && currentForm.Code = forms.GeneralInfoForm.Code
        Width: =sheet_CandidateScreen.BodyWidth
        X: =sheet_CandidateScreen.BodyX
        Y: =sheet_CandidateScreen.BodyY
        ZIndex: =6

    frmJobContractInfo_CandidateScreen As JobContractInfoForm:
        ADFIUsers: =ISignatureAPI.GetUsers(UserType.ADFI)
        ClientItems: |-
            =If(
                IsBlank(jobPosition.clients) || IsEmpty(jobPosition.clients),
                Sort(
                    AppFunctions.ForFixAccents(ISignatureAPI.GetCustomFieldOptions("Client")),
                    Value
                ),
                jobPosition.clients
            )
        CompensationValue: |-
            =$"$ {AppFunctions.FormatAmout(
                If(
                    jobContractData.GeneralInfo.Exists,
                    jobContractData.GeneralInfo.Source.compensation,
                    signedJobOffer.financialBreakdown.totalGrossSalary
                )
            )} {signedJobOffer.salaryPackage.currency}"
        Default: |-
            =If(
                jobContractData.GeneralInfo.Exists,
                jobContractData.GeneralInfo.Source,
                Patch(
                    jobContractData.GeneralInfo.Source,
                    {
                        workingHours: signedJobOffer.generalInfo.workingHours,
                        client: If(
                            !IsBlank(jobPosition.clients) && !IsBlank(jobPosition.clients) && CountRows(jobPosition.clients) = 1,
                            First(jobPosition.clients).Value
                        ),
                        extraJobActivities: jobPosition.jobActivities,
                        compensation: signedJobOffer.financialBreakdown.totalGrossSalary
                    }
                )
            )
        FormMode: =AppFunctions.BooleanToFormMode(jobContractData.GeneralInfo.Exists)
        GetValue: |-
            ={
                userADFI: Self.ADFIUser.Value,
                userHC: Self.TotalRewardsUser.Value,
                workingHours: Self.WorkingHours.Value,
                extraJobActivities: Self.JobActivities.Value,
                client: Self.Client.Value,
                workLocation: Self.WorkLocation.Value,
                compensation: JobContractInfoForm.Default.compensation
            }
        Height: =sheet_CandidateScreen.BodyHeight
        IsLoading: =isSavingForm
        LocationItems: =jobPosition.locations
        PaddingBottom: =15
        PaddingTop: =15
        TableToUL: =AppFunctions.TableToUL(Table)
        TotalRewardsUsers: =ISignatureAPI.GetUsers(UserType.TotalRewards)
        ULToTable: =AppFunctions.ULToTable(HTMLText)
        Visible: =sheetVisible && currentForm.Code = forms.JobContractInfoForm.Code
        Width: =sheet_CandidateScreen.BodyWidth
        X: =sheet_CandidateScreen.BodyX
        Y: =sheet_CandidateScreen.BodyY
        ZIndex: =7

    basicInputDialog_CandidateScreen As BasicInputDialog:
        AcceptButtonWidth: =optionDialogModel.AcceptButtonWidth
        AcceptText: =optionDialogModel.AcceptText
        CancelButtonWidth: =optionDialogModel.CancelButtonWidth
        CancelText: =optionDialogModel.CancelText
        Default: =optionDialogModel.Default
        InputIsRequired: =optionDialogModel.InputIsRequired
        LabelText: =optionDialogModel.InputLabel
        Message: =optionDialogModel.Message
        ModalHeight: =optionDialogModel.ModalHeight
        ModalWidth: =optionDialogModel.ModalWidth
        OnSelectAccept: |-
            =With(
                optionDialogModel,
                UpdateContext({optionDialogModel: Blank()});
                UpdateContext({popLoadVisible: true});
                Switch(
                    Code,
                    "cancel_version",//-----------------------------------------------------------------------------------------------------------------
                    IfError(
                        With(
                            With(
                                Patch(
                                    version.Source,
                                    {status: VersionState.Canceled.Code}
                                ) As requestBody,
                                Switch(
                                    processStep.Code,
                                    DeepScreen.Candidate.JobOffer.Code,
                                    ISignatureAPI.UpdateVersion(requestBody),
                                    DeepScreen.Candidate.JobContract.Code,
                                    ISignatureAPI.UpdateJobContractVersion(requestBody)
                                )
                            ) As response,
                            AppFunctions.NotifySuccess(
                                $"{processStep.Name} canceled!",
                                $"The {processStep.LowerName} <strong>{version.Source.version}</strong> has been canceled."
                            );
                            versioningPanel_CandidateScreen.Refresh()
                        ),
                        AppFunctions.NotifyError(
                            $"Error canceling {processStep.LowerName} version!",
                            FirstError.Message,
                            $"The {processStep.LowerName} <strong>{version.Source.version}</strong> could not be cancelled."
                        )
                    ),
                    "request_salary_assignment",//------------------------------------------------------------------------------------------------------------------
                    IfError(
                        With(
                            ISignatureAPI.CreateSalaryPackage(
                                {
                                    status: VersionSectionState.Waiting.Code,
                                    idJobOffer: version.Source.id,
                                    requested: true,
                                    userLastUpdatedBy: CurrentUser,
                                    userAssignedBy: AppFunctions.ManagerToUser(
                                        LookUp(
                                            jobPosition.hiringManagers,
                                            primary
                                        )
                                    ),
                                    comment: basicInputDialog_CandidateScreen.UserInput
                                }
                            ),
                            AppFunctions.NotifySuccess(
                                "Request sent!",
                                $"The request for filling out salary compensation has been sent to the manager <strong>{LookUp(
                                    jobPosition.hiringManagers,
                                    primary
                                ).name}</strong>."
                            );
                            versioningPanel_CandidateScreen.Select()
                        ),
                        AppFunctions.NotifyError(
                            "Failed to make request!",
                            FirstError.Message,
                            $"An error occurred while requesting salary compensation filling from the manager."
                        )
                    ),
                    "request_breakdown",//------------------------------------------------------------------------------------------------------------------
                    IfError(
                        With(
                            ISignatureAPI.CreateFinancialBreakdown(
                                {
                                    idJobOffer: version.Source.id,
                                    status: VersionSectionState.Waiting.Code,
                                    requested: true,
                                    userLastUpdatedBy: CurrentUser,
                                    userFilledBy: jobOfferData.GeneralInfo.Source.userADFI
                                }
                            ),
                            AppFunctions.NotifySuccess(
                                "Request sent!",
                                $"The request for filling out the breakdown has been sent to the ADFI user <strong>{jobOfferData.GeneralInfo.Source.userADFI.name}</strong>."
                            );
                            versioningPanel_CandidateScreen.Select()
                        ),
                        AppFunctions.NotifyError(
                            "Failed to make request!",
                            FirstError.Message,
                            $"An error occurred while requesting financial breakdown filling from the ADFI user."
                        )
                    ),
                    "fill_breakdown",//------------------------------------------------------------------------------------------------------------------
                    With(
                        {
                            name: jobOfferData.FinancialBreakdown.Source.name,
                            idJobOffer: version.Source.id,
                            status: VersionSectionState.Completed.Code,
                            content: "[]",
                            grossSalary: jobOfferData.SalaryPackage.Source.compensation,
                            dailySalary: jobOfferData.SalaryPackage.Source.compensation / 30.4,
                            monthlySalary: jobOfferData.SalaryPackage.Source.compensation,
                            totalGrossSalary: jobOfferData.SalaryPackage.Source.compensation,
                            totalRetentions: 0,
                            modifiedOn: AppFunctions.NowAsUTC,
                            requested: false,
                            userLastUpdatedBy: CurrentUser,
                            userFilledBy: If(
                                jobOfferData.FinancialBreakdown.Exists,
                                jobOfferData.FinancialBreakdown.Source.userFilledBy,
                                CurrentUser
                            )
                        } As requestBody,
                        IfError(
                            With(
                                If(
                                    jobOfferData.FinancialBreakdown.Exists,
                                    ISignatureAPI.UpdateFinancialBreakdown(
                                        Patch(
                                            requestBody,
                                            {id: jobOfferData.FinancialBreakdown.Source.id}
                                        )
                                    ),
                                    ISignatureAPI.CreateFinancialBreakdown(requestBody)
                                ) As financialBreakdownResponse,
                                With(
                                    If(
                                        version.Source.status <> VersionState.Filled.Code,
                                        ISignatureAPI.UpdateVersion(
                                            Patch(
                                                version.Source,
                                                {status: VersionState.Filled.Code}
                                            )
                                        ),
                                        Blank()
                                    ) As versionResponse,
                                    AppFunctions.NotifySuccess(
                                        "Data save successfully!",
                                        "The financial breakdown has been correctly assigned to the candidate's job offer."
                                    );
                                    If(
                                        version.Source.status = VersionState.Filled.Code,
                                        versioningPanel_CandidateScreen.Select(),
                                        versioningPanel_CandidateScreen.Refresh()
                                    )
                                )
                            ),
                            AppFunctions.NotifyError(
                                "Error saving financial breakdown!",
                                FirstError.Message,
                                "An error occurred while trying to save financial breakdown data."
                            )
                        )
                    ),
                    "send_job_offer",//------------------------------------------------------------------------------------------------------------------
                    IfError(
                        With(
                            ISignatureAPI.SendJobOffer(version.Source.id),
                            With(
                                ISignatureAPI.UpdateVersion(
                                    Patch(
                                        version.Source,
                                        {status: VersionState.Sent.Code}
                                    )
                                ) As updateVersionResponse,
                                AppFunctions.NotifySuccess(
                                    $"{processStep.Name} sent for signature!",
                                    $"The {processStep.LowerName} <strong>{version.Source.version}</strong> has been sent to <strong>{candidate.candidateState.candidateInfo.fullName}</strong> to sign."
                                );
                                versioningPanel_CandidateScreen.Refresh()
                            )
                        ),
                        AppFunctions.NotifyError(
                            "Error sending signature request!",
                            FirstError.Message
                        )
                    ),
                    "send_job_contract",//------------------------------------------------------------------------------------------------------------------
                    IfError(
                        With(
                            ISignatureAPI.SendJobContract(version.Source.id),
                            With(
                                ISignatureAPI.UpdateJobContractVersion(
                                    Patch(
                                        version.Source,
                                        {status: VersionState.Sent.Code}
                                    )
                                ) As updateVersionResponse,
                                AppFunctions.NotifySuccess(
                                    $"{processStep.Name} sent for signature!",
                                    $"The {processStep.LowerName} <strong>{version.Source.version}</strong> has been sent to <strong>{candidate.candidateState.candidateInfo.fullName}</strong> to sign."
                                );
                                versioningPanel_CandidateScreen.Refresh()
                            )
                        ),
                        AppFunctions.NotifyError(
                            "Error sending signature request!",
                            FirstError.Message
                        )
                    ),
                    "send_candidate_form",//------------------------------------------------------------------------------------------------------------------
                    IfError(
                        With(
                            LookUp(
                                candidateForms,
                                name = jobContractData.Metadata.Value.defaultForm
                            ) As form,
                            If(
                                IsBlank(form),
                                Error("No se encontr el formulario por defecto"),
                                With(
                                    ISignatureAPI.CreateCandidateInfo(
                                        {
                                            status: VersionSectionState.Waiting.Code,
                                            idJobContract: version.Source.id,
                                            form: form
                                        }
                                    ),
                                    AppFunctions.NotifySuccess(
                                        "Form sent to candidate!",
                                        $"The request for filling out the form has been sent to the candidate <strong>{candidate.candidateState.candidateInfo.fullName}</strong>."
                                    );
                                    versioningPanel_CandidateScreen.Select()
                                )
                            )
                        ),
                        AppFunctions.NotifyError(
                            "Error sending form to candidate!",
                            FirstError.Message
                        ),
                        Blank()
                    )
                );
                UpdateContext({popLoadVisible: false})
            )
        OnSelectCancel: |-
            =UpdateContext({optionDialogModel: Blank()})
        SelectAccept: =Self.OnSelectAccept()
        SelectCancel: =Self.OnSelectCancel()
        ShowInput: =optionDialogModel.ShowInput
        Title: =optionDialogModel.Title
        Visible: =!IsBlank(optionDialogModel)
        ZIndex: =8

    notificationPanel_CandidateScreen As Notifications:
        ClearAll: =Self.OnClearAll()
        OnCloseNotification: |-
            =RemoveIf(
                GlobalNotifications,
                ThisRecord.Id = Notification.Id
            )
        OnSelectClose: |-
            =UpdateContext({notificationPanelVisible: false})
        SelectClose: =Self.OnSelectClose()
        Visible: =notificationPanelVisible
        ZIndex: =9

    shareDialog_CandidateScreen As ShareDialog:
        OnSelectClose: |-
            =UpdateContext({shareDialogModel: Blank()})
        Param: =shareDialogModel.Param
        ResourceId: =shareDialogModel.ResourceId
        SelectClose: =Self.OnSelectClose()
        Title: =shareDialogModel.Title
        Visible: =!IsBlank(shareDialogModel)
        ZIndex: =10

    popLoad_CandidateScreen As PopupImager:
        Height: =Parent.Height
        Img: =Style.Loader
        Visible: =popLoadVisible
        Width: =Parent.Width
        ZIndex: =11

    notificationCard_CandidateScreen As NotificationCard:
        OnSelectClose: |-
            =Set(
                NotificationCardVisible,
                false
            )
        SelectClose: =Self.OnSelectClose()
        Visible: =NotificationCardVisible
        X: =Parent.Width - Self.Width
        Y: =50
        ZIndex: =12

